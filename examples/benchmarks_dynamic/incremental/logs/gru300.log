['main.py', 'run_all', '--forecast_model', 'GRU', '-num_head', '8', '--train_start=2008-01-01', '--train_end=2018-12-31', '--valid_start=2019-01-01', '--valid_end=2020-03-31', '--test_start=2020-04-01', '--test_end=2024-03-31', '--tau', '10', '--lr_da', '0.01', '--market', 'csi300', '--data_dir', 'crowd_data', '--rank_label', 'False', '--begin_valid_epoch', '30']
[2889964:MainThread](2024-04-24 19:39:56,798) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[2889964:MainThread](2024-04-24 19:39:56,800) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[2889964:MainThread](2024-04-24 19:39:56,801) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[2889964:MainThread](2024-04-24 19:40:28,326) INFO - qlib.timer - [log.py:127] - Time cost: 31.513s | Loading data Done
[2889964:MainThread](2024-04-24 19:43:31,606) INFO - qlib.timer - [log.py:127] - Time cost: 177.050s | RobustZScoreNorm Done
[2889964:MainThread](2024-04-24 19:43:34,802) INFO - qlib.timer - [log.py:127] - Time cost: 3.196s | Fillna Done
[2889964:MainThread](2024-04-24 19:43:37,233) INFO - qlib.timer - [log.py:127] - Time cost: 1.676s | DropnaLabel Done
[2889964:MainThread](2024-04-24 19:43:46,660) INFO - qlib.timer - [log.py:127] - Time cost: 9.426s | CSZScoreNorm Done
[2889964:MainThread](2024-04-24 19:43:46,665) INFO - qlib.timer - [log.py:127] - Time cost: 198.338s | fit & process data Done
[2889964:MainThread](2024-04-24 19:43:46,665) INFO - qlib.timer - [log.py:127] - Time cost: 229.853s | Init data Done
Save handler file to /home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[2889964:MainThread](2024-04-24 19:44:13,020) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  28%|██▊       | 41/147 [00:00<00:00, 400.74it/s]creating meta tasks:  58%|█████▊    | 85/147 [00:00<00:00, 418.69it/s]creating meta tasks:  87%|████████▋ | 128/147 [00:00<00:00, 423.62it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 421.70it/s]
[2889964:MainThread](2024-04-24 19:44:13,690) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  54%|█████▍    | 34/63 [00:00<00:00, 333.01it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 332.18it/s]
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 19:44:14,517) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 19:44:14,602) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 19:44:14,603) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 19:44:14,604) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:23,  8.72s/it]epoch:   2%|▏         | 2/100 [00:16<13:09,  8.06s/it]epoch:   3%|▎         | 3/100 [00:23<12:29,  7.73s/it]epoch:   4%|▍         | 4/100 [00:31<12:13,  7.64s/it]epoch:   5%|▌         | 5/100 [00:38<11:50,  7.48s/it]epoch:   6%|▌         | 6/100 [00:45<11:33,  7.38s/it]epoch:   7%|▋         | 7/100 [00:52<11:24,  7.37s/it]epoch:   8%|▊         | 8/100 [01:00<11:22,  7.41s/it]epoch:   9%|▉         | 9/100 [01:07<11:11,  7.38s/it]epoch:  10%|█         | 10/100 [01:14<10:58,  7.31s/it]epoch:  11%|█         | 11/100 [01:21<10:43,  7.23s/it]epoch:  12%|█▏        | 12/100 [01:28<10:30,  7.16s/it]epoch:  13%|█▎        | 13/100 [01:36<10:25,  7.19s/it]epoch:  14%|█▍        | 14/100 [01:43<10:22,  7.24s/it]epoch:  15%|█▌        | 15/100 [01:50<10:16,  7.25s/it]epoch:  16%|█▌        | 16/100 [01:58<10:08,  7.24s/it]epoch:  17%|█▋        | 17/100 [02:05<10:00,  7.24s/it]epoch:  18%|█▊        | 18/100 [02:12<09:52,  7.23s/it]epoch:  19%|█▉        | 19/100 [02:19<09:45,  7.23s/it]epoch:  20%|██        | 20/100 [02:26<09:39,  7.24s/it]epoch:  21%|██        | 21/100 [02:34<09:34,  7.27s/it]epoch:  22%|██▏       | 22/100 [02:41<09:29,  7.30s/it]epoch:  23%|██▎       | 23/100 [02:48<09:20,  7.27s/it]epoch:  24%|██▍       | 24/100 [02:56<09:12,  7.27s/it]epoch:  25%|██▌       | 25/100 [03:03<09:04,  7.26s/it]epoch:  26%|██▌       | 26/100 [03:10<08:56,  7.25s/it]epoch:  27%|██▋       | 27/100 [03:17<08:46,  7.21s/it]epoch:  28%|██▊       | 28/100 [03:25<08:44,  7.28s/it]epoch:  29%|██▉       | 29/100 [03:32<08:39,  7.32s/it]epoch:  30%|███       | 30/100 [03:39<08:28,  7.27s/it]0.06130230293538905
best ic: 0.06130230293538905
epoch:  31%|███       | 31/100 [03:48<08:50,  7.68s/it]0.05830481955068743
epoch:  32%|███▏      | 32/100 [03:56<08:54,  7.85s/it]0.05645173790623476
epoch:  33%|███▎      | 33/100 [04:04<08:54,  7.98s/it]0.0586717381558569
epoch:  34%|███▍      | 34/100 [04:13<08:52,  8.07s/it]0.058506647647020966
epoch:  35%|███▌      | 35/100 [04:21<08:52,  8.20s/it]0.055928105013148106
epoch:  36%|███▌      | 36/100 [04:30<08:50,  8.29s/it]0.05865664262966913
epoch:  37%|███▋      | 37/100 [04:38<08:43,  8.31s/it]0.05760797829525662
epoch:  38%|███▊      | 38/100 [04:46<08:33,  8.28s/it]0.05614937990713827
epoch:  38%|███▊      | 38/100 [04:54<08:01,  7.76s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 19:49:13,889) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online.
[2889964:MainThread](2024-04-24 19:49:13,945) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 19:49:14,903) INFO - qlib.workflow - [recorder.py:341] - Recorder 2cb21da1c3af4a52afe4bb898c3597e9 starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 14.51it/s]online:   6%|▋         | 4/63 [00:00<00:04, 14.61it/s]online:  10%|▉         | 6/63 [00:00<00:03, 14.64it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 14.81it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 14.73it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 14.67it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 14.35it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 14.34it/s]online:  29%|██▊       | 18/63 [00:01<00:03, 14.37it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 14.44it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 14.73it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 14.64it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 14.71it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 14.51it/s]online:  48%|████▊     | 30/63 [00:02<00:02, 14.46it/s]online:  51%|█████     | 32/63 [00:02<00:02, 14.55it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 14.54it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 14.80it/s]online:  60%|██████    | 38/63 [00:02<00:01, 14.95it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 15.08it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 15.07it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 15.11it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 15.15it/s]online:  76%|███████▌  | 48/63 [00:03<00:00, 15.18it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 15.17it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 15.25it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 15.21it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 15.09it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 14.99it/s]online:  95%|█████████▌| 60/63 [00:04<00:00, 15.11it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 15.14it/s]online: 100%|██████████| 63/63 [00:04<00:00, 13.97it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 19:49:27,205) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99661684 mae 0.7074261
{'IC': 0.034938309895588854,
 'ICIR': 0.26443813642226155,
 'Rank IC': 0.03540672677594329,
 'Rank ICIR': 0.2681827971385148}
[2889964:MainThread](2024-04-24 19:49:28,887) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 19:49:41,607) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 19:49:41,611) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 19:49:47,861) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fad68f6cd30>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:17, 55.67it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 51.93it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:16, 56.52it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:17, 53.58it/s]backtest loop:   3%|▎         | 32/971 [00:00<00:16, 56.63it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:16, 55.06it/s]backtest loop:   5%|▍         | 46/971 [00:00<00:16, 57.73it/s]backtest loop:   5%|▌         | 52/971 [00:00<00:15, 58.36it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:16, 55.58it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:15, 57.91it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:15, 56.95it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 58.49it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:14, 59.59it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 56.62it/s]backtest loop:  10%|█         | 99/971 [00:01<00:14, 58.87it/s]backtest loop:  11%|█         | 105/971 [00:01<00:14, 59.18it/s]backtest loop:  12%|█▏        | 112/971 [00:01<00:15, 56.85it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.57it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 56.07it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.95it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.51it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.43it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 56.02it/s]backtest loop:  16%|█▌        | 157/971 [00:02<00:14, 56.92it/s]backtest loop:  17%|█▋        | 164/971 [00:02<00:13, 58.78it/s]backtest loop:  18%|█▊        | 170/971 [00:02<00:13, 58.19it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.64it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 57.89it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.26it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.41it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.71it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.64it/s]backtest loop:  22%|██▏       | 216/971 [00:03<00:13, 54.36it/s]backtest loop:  23%|██▎       | 223/971 [00:03<00:13, 56.66it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.28it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.40it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.13it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.42it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.41it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.80it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.25it/s]backtest loop:  29%|██▊       | 278/971 [00:04<00:12, 57.59it/s]backtest loop:  29%|██▉       | 285/971 [00:04<00:11, 59.14it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:18, 36.04it/s]backtest loop:  31%|███       | 297/971 [00:05<00:16, 40.55it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:14, 45.67it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:14, 46.51it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:12, 50.63it/s]backtest loop:  33%|███▎      | 324/971 [00:05<00:12, 53.83it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:12, 52.50it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:11, 55.36it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 57.57it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 55.05it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 56.25it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:11, 55.17it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.49it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 56.07it/s]backtest loop:  39%|███▉      | 383/971 [00:06<00:10, 55.00it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 57.41it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 58.92it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 56.08it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.99it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.59it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 56.52it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 58.37it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 56.44it/s]backtest loop:  46%|████▌     | 444/971 [00:07<00:09, 58.49it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.60it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.58it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 58.41it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.65it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.59it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 58.55it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.82it/s]backtest loop:  51%|█████     | 496/971 [00:08<00:08, 56.62it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:07, 58.74it/s]backtest loop:  52%|█████▏    | 509/971 [00:09<00:08, 56.20it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:07, 58.40it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 55.88it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 58.09it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 56.40it/s]backtest loop:  56%|█████▌    | 542/971 [00:09<00:07, 57.08it/s]backtest loop:  57%|█████▋    | 549/971 [00:09<00:07, 58.87it/s]backtest loop:  57%|█████▋    | 555/971 [00:09<00:07, 59.16it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 55.89it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 56.90it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:06, 58.71it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.70it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.31it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.66it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 56.94it/s]backtest loop:  63%|██████▎   | 608/971 [00:10<00:06, 58.66it/s]backtest loop:  63%|██████▎   | 615/971 [00:10<00:06, 57.30it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:05, 58.94it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 60.19it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:05, 57.64it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 59.15it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 57.05it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 58.74it/s]backtest loop:  68%|██████▊   | 664/971 [00:11<00:05, 60.00it/s]backtest loop:  69%|██████▉   | 671/971 [00:11<00:05, 57.54it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:04, 59.03it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 55.90it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.82it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 59.27it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 56.45it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 58.45it/s]backtest loop:  74%|███████▍  | 718/971 [00:12<00:04, 59.75it/s]backtest loop:  75%|███████▍  | 724/971 [00:12<00:04, 56.67it/s]backtest loop:  75%|███████▌  | 730/971 [00:12<00:04, 57.52it/s]backtest loop:  76%|███████▌  | 736/971 [00:13<00:04, 55.47it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 54.51it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.81it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 56.35it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 58.25it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.68it/s]backtest loop:  80%|████████  | 777/971 [00:13<00:03, 57.58it/s]backtest loop:  81%|████████  | 783/971 [00:13<00:03, 55.59it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.79it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 59.39it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:02, 56.22it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 58.19it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 59.58it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.27it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 58.17it/s]backtest loop:  86%|████████▌ | 837/971 [00:14<00:02, 59.54it/s]backtest loop:  87%|████████▋ | 843/971 [00:14<00:02, 56.49it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 58.36it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 56.71it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 58.37it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.59it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.59it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 58.47it/s]backtest loop:  92%|█████████▏| 891/971 [00:15<00:01, 59.82it/s]backtest loop:  92%|█████████▏| 898/971 [00:15<00:01, 57.50it/s]backtest loop:  93%|█████████▎| 905/971 [00:15<00:01, 59.07it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 57.07it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:00, 57.78it/s]backtest loop:  95%|█████████▌| 925/971 [00:16<00:00, 59.08it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.17it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.18it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 56.26it/s]backtest loop:  98%|█████████▊| 952/971 [00:16<00:00, 58.32it/s]backtest loop:  99%|█████████▉| 959/971 [00:16<00:00, 59.67it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 56.75it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.70it/s]
[2889964:MainThread](2024-04-24 19:50:05,058) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000479
std                0.004934
annualized_return  0.113984
information_ratio  1.497407
max_drawdown      -0.108008
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000283
std                0.004936
annualized_return  0.067401
information_ratio  0.885177
max_drawdown      -0.139956
[2889964:MainThread](2024-04-24 19:50:05,074) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 1 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198],
 'IC': [0.034938309895588854],
 'ICIR': [0.26443813642226155],
 'Rank IC': [0.03540672677594329],
 'Rank ICIR': [0.2681827971385148],
 'mae': [0.7074260711669922],
 'mse': [0.9966168403625488]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 19:50:06,319) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 19:50:06,320) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 19:50:06,321) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 19:50:06,322) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:13,  7.41s/it]epoch:   2%|▏         | 2/100 [00:14<11:47,  7.21s/it]epoch:   3%|▎         | 3/100 [00:21<11:40,  7.22s/it]epoch:   4%|▍         | 4/100 [00:28<11:32,  7.21s/it]epoch:   5%|▌         | 5/100 [00:36<11:27,  7.24s/it]epoch:   6%|▌         | 6/100 [00:43<11:25,  7.29s/it]epoch:   7%|▋         | 7/100 [00:50<11:12,  7.23s/it]epoch:   8%|▊         | 8/100 [00:57<11:05,  7.24s/it]epoch:   9%|▉         | 9/100 [01:05<10:56,  7.21s/it]epoch:  10%|█         | 10/100 [01:12<10:43,  7.15s/it]epoch:  11%|█         | 11/100 [01:19<10:37,  7.16s/it]epoch:  12%|█▏        | 12/100 [01:26<10:30,  7.17s/it]epoch:  13%|█▎        | 13/100 [01:33<10:28,  7.23s/it]epoch:  14%|█▍        | 14/100 [01:41<10:23,  7.25s/it]epoch:  15%|█▌        | 15/100 [01:48<10:17,  7.27s/it]epoch:  16%|█▌        | 16/100 [01:55<10:07,  7.23s/it]epoch:  17%|█▋        | 17/100 [02:02<09:57,  7.20s/it]epoch:  18%|█▊        | 18/100 [02:09<09:47,  7.17s/it]epoch:  19%|█▉        | 19/100 [02:16<09:40,  7.16s/it]epoch:  20%|██        | 20/100 [02:24<09:36,  7.21s/it]epoch:  21%|██        | 21/100 [02:31<09:33,  7.25s/it]epoch:  22%|██▏       | 22/100 [02:38<09:25,  7.25s/it]epoch:  23%|██▎       | 23/100 [02:45<09:13,  7.19s/it]epoch:  24%|██▍       | 24/100 [02:53<09:08,  7.22s/it]epoch:  25%|██▌       | 25/100 [03:00<09:02,  7.24s/it]epoch:  26%|██▌       | 26/100 [03:07<08:53,  7.21s/it]epoch:  27%|██▋       | 27/100 [03:14<08:43,  7.17s/it]epoch:  28%|██▊       | 28/100 [03:22<08:40,  7.23s/it]epoch:  29%|██▉       | 29/100 [03:29<08:38,  7.30s/it]epoch:  30%|███       | 30/100 [03:36<08:31,  7.30s/it]0.057563754177493015
best ic: 0.057563754177493015
epoch:  31%|███       | 31/100 [03:45<08:45,  7.62s/it]0.056364942905443687
epoch:  32%|███▏      | 32/100 [03:53<08:51,  7.82s/it]0.05582946281695078
epoch:  33%|███▎      | 33/100 [04:01<08:53,  7.96s/it]0.05590950749222126
epoch:  34%|███▍      | 34/100 [04:10<08:52,  8.07s/it]0.0570953255418804
epoch:  35%|███▌      | 35/100 [04:18<08:52,  8.19s/it]0.054381294027279425
epoch:  36%|███▌      | 36/100 [04:26<08:46,  8.23s/it]0.05309136236993077
epoch:  37%|███▋      | 37/100 [04:35<08:36,  8.19s/it]0.054393703030689564
epoch:  38%|███▊      | 38/100 [04:43<08:29,  8.21s/it]0.054360322535650374
epoch:  38%|███▊      | 38/100 [04:51<07:55,  7.67s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 19:54:57,871) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 19:54:57,882) INFO - qlib.workflow - [recorder.py:341] - Recorder a1e8fed74a5b4cebb189da8892cf67da starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.04it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.64it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.41it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.73it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.55it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 17.01it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 17.20it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 17.19it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 17.38it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 17.37it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 17.29it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 17.41it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 17.43it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 17.34it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 17.33it/s]online:  51%|█████     | 32/63 [00:01<00:01, 17.47it/s]online:  54%|█████▍    | 34/63 [00:01<00:01, 17.53it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 17.56it/s]online:  60%|██████    | 38/63 [00:02<00:01, 17.42it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 17.51it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 17.50it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 17.43it/s]online:  73%|███████▎  | 46/63 [00:02<00:00, 17.44it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 17.44it/s]online:  79%|███████▉  | 50/63 [00:02<00:00, 17.32it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 17.41it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 17.31it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 17.36it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 17.48it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 17.34it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 17.45it/s]online: 100%|██████████| 63/63 [00:03<00:00, 17.32it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 19:55:13,344) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99635375 mae 0.7075469
{'IC': 0.0319837277968849,
 'ICIR': 0.2333118121315035,
 'Rank IC': 0.03222908078267821,
 'Rank ICIR': 0.2361252561206688}
[2889964:MainThread](2024-04-24 19:55:15,018) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 19:55:27,783) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 19:55:27,786) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 19:55:33,856) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa68313a340>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.77it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.78it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 36.82it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.16it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.21it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 52.38it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.68it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 54.91it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.29it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 56.46it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.30it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.84it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:15, 56.83it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:15, 58.55it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.95it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.60it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 59.32it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:14, 57.09it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.86it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 55.93it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 54.12it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 56.68it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 58.61it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 56.11it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 58.05it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 59.55it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 56.53it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 58.41it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.76it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 57.57it/s]backtest loop:  21%|██        | 203/971 [00:03<00:12, 59.34it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 57.18it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 55.34it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 56.33it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 58.32it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.62it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 57.68it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:12, 55.92it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 57.88it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:11, 59.31it/s]backtest loop:  28%|██▊       | 269/971 [00:04<00:12, 56.38it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 55.10it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 57.14it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.76it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.32it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.42it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 58.90it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 55.84it/s]backtest loop:  33%|███▎      | 322/971 [00:05<00:11, 57.66it/s]backtest loop:  34%|███▍      | 329/971 [00:05<00:10, 59.51it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.64it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 58.11it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.71it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.58it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 58.68it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.74it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 55.47it/s]backtest loop:  39%|███▉      | 382/971 [00:06<00:10, 57.48it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 55.16it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 57.23it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.92it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.82it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.68it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 59.17it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 56.18it/s]backtest loop:  45%|████▍     | 434/971 [00:07<00:09, 57.09it/s]backtest loop:  45%|████▌     | 441/971 [00:07<00:09, 58.75it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 55.79it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 56.67it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 58.44it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.33it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 58.42it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.64it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.55it/s]backtest loop:  51%|█████     | 494/971 [00:08<00:08, 58.37it/s]backtest loop:  51%|█████▏    | 500/971 [00:08<00:08, 55.48it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.62it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 57.12it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.78it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.92it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 58.19it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 56.37it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 58.18it/s]backtest loop:  57%|█████▋    | 555/971 [00:09<00:06, 59.60it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.50it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.27it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.71it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.71it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.50it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 58.84it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 55.89it/s]backtest loop:  63%|██████▎   | 607/971 [00:10<00:06, 57.91it/s]backtest loop:  63%|██████▎   | 614/971 [00:10<00:06, 59.35it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:10, 34.69it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:08, 40.43it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:07, 45.65it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:07, 46.74it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:06, 50.86it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 53.99it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 52.50it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 54.35it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 54.69it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 53.81it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:05, 56.25it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 58.15it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.47it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.60it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.22it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 56.10it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.02it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.63it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.07it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:03, 56.52it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.41it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.85it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 55.29it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 57.38it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.97it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 56.12it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.96it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.33it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.50it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 58.10it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 58.16it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 55.46it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 57.68it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 59.19it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.16it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 58.07it/s]backtest loop:  88%|████████▊ | 856/971 [00:15<00:01, 58.59it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 55.68it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.83it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.25it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.34it/s]backtest loop:  92%|█████████▏| 889/971 [00:16<00:01, 58.30it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 59.63it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 56.45it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 58.20it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 56.45it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 58.24it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.48it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 56.39it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 58.30it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 56.60it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 58.44it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.77it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 57.52it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.73it/s]
[2889964:MainThread](2024-04-24 19:55:51,346) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000695
std                0.004720
annualized_return  0.165368
information_ratio  2.271051
max_drawdown      -0.059686
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000497
std                0.004721
annualized_return  0.118316
information_ratio  1.624669
max_drawdown      -0.088718
[2889964:MainThread](2024-04-24 19:55:51,360) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 2 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668],
 'IC': [0.034938309895588854, 0.0319837277968849],
 'ICIR': [0.26443813642226155, 0.2333118121315035],
 'Rank IC': [0.03540672677594329, 0.03222908078267821],
 'Rank ICIR': [0.2681827971385148, 0.2361252561206688],
 'mae': [0.7074260711669922, 0.7075468897819519],
 'mse': [0.9966168403625488, 0.9963537454605103]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 19:55:52,637) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 19:55:52,637) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 19:55:52,639) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 19:55:52,639) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:17,  7.45s/it]epoch:   2%|▏         | 2/100 [00:14<11:59,  7.34s/it]epoch:   3%|▎         | 3/100 [00:22<11:52,  7.34s/it]epoch:   4%|▍         | 4/100 [00:29<11:39,  7.28s/it]epoch:   5%|▌         | 5/100 [00:36<11:29,  7.25s/it]epoch:   6%|▌         | 6/100 [00:43<11:17,  7.21s/it]epoch:   7%|▋         | 7/100 [00:50<11:07,  7.18s/it]epoch:   8%|▊         | 8/100 [00:57<11:03,  7.21s/it]epoch:   9%|▉         | 9/100 [01:05<10:57,  7.23s/it]epoch:  10%|█         | 10/100 [01:12<10:51,  7.24s/it]epoch:  11%|█         | 11/100 [01:19<10:47,  7.28s/it]epoch:  12%|█▏        | 12/100 [01:27<10:41,  7.29s/it]epoch:  13%|█▎        | 13/100 [01:34<10:31,  7.26s/it]epoch:  14%|█▍        | 14/100 [01:41<10:25,  7.27s/it]epoch:  15%|█▌        | 15/100 [01:48<10:17,  7.27s/it]epoch:  16%|█▌        | 16/100 [01:56<10:06,  7.22s/it]epoch:  17%|█▋        | 17/100 [02:03<10:02,  7.26s/it]epoch:  18%|█▊        | 18/100 [02:10<09:57,  7.29s/it]epoch:  19%|█▉        | 19/100 [02:18<09:54,  7.34s/it]epoch:  20%|██        | 20/100 [02:25<09:41,  7.27s/it]epoch:  21%|██        | 21/100 [02:32<09:30,  7.23s/it]epoch:  22%|██▏       | 22/100 [02:39<09:21,  7.20s/it]epoch:  23%|██▎       | 23/100 [02:46<09:12,  7.18s/it]epoch:  24%|██▍       | 24/100 [02:53<09:06,  7.18s/it]epoch:  25%|██▌       | 25/100 [03:01<09:02,  7.24s/it]epoch:  26%|██▌       | 26/100 [03:08<08:55,  7.24s/it]epoch:  27%|██▋       | 27/100 [03:15<08:50,  7.26s/it]epoch:  28%|██▊       | 28/100 [03:23<08:42,  7.25s/it]epoch:  29%|██▉       | 29/100 [03:30<08:31,  7.21s/it]epoch:  30%|███       | 30/100 [03:37<08:25,  7.21s/it]0.05745428453428098
best ic: 0.05745428453428098
epoch:  31%|███       | 31/100 [03:45<08:38,  7.51s/it]0.05591664302394358
epoch:  32%|███▏      | 32/100 [03:53<08:48,  7.77s/it]0.061279123714216344
best ic: 0.061279123714216344
epoch:  33%|███▎      | 33/100 [04:02<08:53,  7.96s/it]0.06333643599286243
best ic: 0.06333643599286243
epoch:  34%|███▍      | 34/100 [04:10<08:51,  8.05s/it]0.05730708614557434
epoch:  35%|███▌      | 35/100 [04:18<08:47,  8.12s/it]0.06155610194631256
epoch:  36%|███▌      | 36/100 [04:27<08:43,  8.18s/it]0.05809763947498533
epoch:  37%|███▋      | 37/100 [04:35<08:36,  8.19s/it]0.05792576067171889
epoch:  38%|███▊      | 38/100 [04:43<08:28,  8.20s/it]0.05488157056272846
epoch:  39%|███▉      | 39/100 [04:52<08:25,  8.28s/it]0.05977707174868992
epoch:  40%|████      | 40/100 [05:00<08:20,  8.34s/it]0.05819149151046808
epoch:  41%|████      | 41/100 [05:08<08:11,  8.34s/it]0.05654545009010244
epoch:  41%|████      | 41/100 [05:17<07:36,  7.74s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 20:01:09,831) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 20:01:09,842) INFO - qlib.workflow - [recorder.py:341] - Recorder 330d40846c9541b3ac73dbcfa0e27a01 starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.48it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.58it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.78it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.91it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.77it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.58it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.65it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.30it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.48it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.56it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.61it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.72it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.67it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.70it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 16.76it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.83it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 17.12it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 17.10it/s]online:  60%|██████    | 38/63 [00:02<00:01, 17.10it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 17.19it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 17.19it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 17.36it/s]online:  73%|███████▎  | 46/63 [00:02<00:00, 17.37it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 17.34it/s]online:  79%|███████▉  | 50/63 [00:02<00:00, 17.32it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.85it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.76it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.78it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.74it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.74it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.64it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.86it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 20:01:25,005) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9966069 mae 0.7075085
{'IC': 0.03141600330561671,
 'ICIR': 0.22755918801990918,
 'Rank IC': 0.031007041976178422,
 'Rank ICIR': 0.22721725134268647}
[2889964:MainThread](2024-04-24 20:01:26,794) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 20:01:39,169) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:01:39,172) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:01:45,243) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa6965fcbb0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.69it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 25.28it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.65it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.02it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.16it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.91it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.51it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.54it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.67it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.38it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.92it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.47it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 59.18it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.31it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.27it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.56it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.52it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.41it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.67it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.70it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.28it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.97it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.44it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 57.88it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 56.22it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 58.14it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 58.61it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:13, 56.58it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.42it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.40it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.16it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.95it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 55.15it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 57.29it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 56.11it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 58.02it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.33it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.53it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.46it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.78it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.48it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:11, 57.93it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 59.37it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.31it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.26it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.33it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 58.25it/s]backtest loop:  33%|███▎      | 318/971 [00:05<00:11, 58.67it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.68it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.67it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.94it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.43it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 59.64it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 57.19it/s]backtest loop:  38%|███▊      | 366/971 [00:06<00:10, 57.40it/s]backtest loop:  38%|███▊      | 372/971 [00:06<00:10, 54.49it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:11, 52.97it/s]backtest loop:  40%|███▉      | 384/971 [00:06<00:10, 54.60it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 56.92it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.31it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.32it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 57.99it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.98it/s]backtest loop:  44%|████▍     | 425/971 [00:07<00:09, 57.82it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:09, 58.26it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 55.43it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 57.66it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.08it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 55.99it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 57.87it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.29it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.28it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 58.01it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.45it/s]backtest loop:  51%|█████     | 497/971 [00:08<00:08, 57.56it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 59.36it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.33it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 55.09it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.09it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.70it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.69it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.13it/s]backtest loop:  57%|█████▋    | 551/971 [00:09<00:07, 56.20it/s]backtest loop:  57%|█████▋    | 558/971 [00:09<00:07, 58.09it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.47it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.37it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.28it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.73it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.58it/s]backtest loop:  61%|██████▏   | 597/971 [00:10<00:06, 57.20it/s]backtest loop:  62%|██████▏   | 604/971 [00:10<00:06, 58.78it/s]backtest loop:  63%|██████▎   | 610/971 [00:10<00:06, 55.81it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:10, 34.15it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:08, 40.03it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:07, 43.36it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:06, 47.93it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:06, 51.91it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:06, 50.92it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 54.09it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 56.51it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 54.45it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 56.93it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 57.68it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.14it/s]backtest loop:  72%|███████▏  | 695/971 [00:12<00:04, 56.10it/s]backtest loop:  72%|███████▏  | 702/971 [00:12<00:04, 57.95it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 55.91it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 57.85it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 59.29it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.38it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.45it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.74it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.44it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.77it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.31it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.12it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.85it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.87it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.26it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.37it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.95it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.10it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.94it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.33it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.34it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 57.21it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 58.83it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.67it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.63it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.58it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 58.43it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.72it/s]backtest loop:  91%|█████████ | 883/971 [00:15<00:01, 57.10it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 58.58it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.57it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 58.20it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 59.51it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.55it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 58.26it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 58.67it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 55.65it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 57.65it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.97it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.85it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.16it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 56.22it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.68it/s]
[2889964:MainThread](2024-04-24 20:02:02,750) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000537
std                0.005092
annualized_return  0.127738
information_ratio  1.626013
max_drawdown      -0.060656
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000340
std                0.005092
annualized_return  0.080842
information_ratio  1.029028
max_drawdown      -0.078344
[2889964:MainThread](2024-04-24 20:02:02,765) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 3 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843,
                                                    0.0808416950970217],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686,
                                                    1.0290283224191858],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668,
                                               -0.07834368021112156],
 'IC': [0.034938309895588854, 0.0319837277968849, 0.03141600330561671],
 'ICIR': [0.26443813642226155, 0.2333118121315035, 0.22755918801990918],
 'Rank IC': [0.03540672677594329, 0.03222908078267821, 0.031007041976178422],
 'Rank ICIR': [0.2681827971385148, 0.2361252561206688, 0.22721725134268647],
 'mae': [0.7074260711669922, 0.7075468897819519, 0.7075085043907166],
 'mse': [0.9966168403625488, 0.9963537454605103, 0.9966068863868713]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 20:02:03,971) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 20:02:03,972) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 20:02:03,973) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 20:02:03,974) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:36,  7.64s/it]epoch:   2%|▏         | 2/100 [00:14<12:03,  7.38s/it]epoch:   3%|▎         | 3/100 [00:22<11:57,  7.40s/it]epoch:   4%|▍         | 4/100 [00:29<11:48,  7.38s/it]epoch:   5%|▌         | 5/100 [00:36<11:37,  7.34s/it]epoch:   6%|▌         | 6/100 [00:43<11:21,  7.25s/it]epoch:   7%|▋         | 7/100 [00:51<11:14,  7.25s/it]epoch:   8%|▊         | 8/100 [00:58<11:04,  7.22s/it]epoch:   9%|▉         | 9/100 [01:05<10:55,  7.20s/it]epoch:  10%|█         | 10/100 [01:12<10:48,  7.21s/it]epoch:  11%|█         | 11/100 [01:20<10:44,  7.24s/it]epoch:  12%|█▏        | 12/100 [01:27<10:36,  7.23s/it]epoch:  13%|█▎        | 13/100 [01:34<10:31,  7.26s/it]epoch:  14%|█▍        | 14/100 [01:41<10:21,  7.23s/it]epoch:  15%|█▌        | 15/100 [01:48<10:11,  7.20s/it]epoch:  16%|█▌        | 16/100 [01:56<10:04,  7.20s/it]epoch:  17%|█▋        | 17/100 [02:03<09:57,  7.20s/it]epoch:  18%|█▊        | 18/100 [02:10<09:56,  7.28s/it]epoch:  19%|█▉        | 19/100 [02:18<09:53,  7.33s/it]epoch:  20%|██        | 20/100 [02:25<09:47,  7.35s/it]epoch:  21%|██        | 21/100 [02:32<09:39,  7.34s/it]epoch:  22%|██▏       | 22/100 [02:40<09:31,  7.32s/it]epoch:  23%|██▎       | 23/100 [02:47<09:23,  7.32s/it]epoch:  24%|██▍       | 24/100 [02:54<09:14,  7.30s/it]epoch:  25%|██▌       | 25/100 [03:01<09:01,  7.22s/it]epoch:  26%|██▌       | 26/100 [03:09<08:57,  7.26s/it]epoch:  27%|██▋       | 27/100 [03:16<08:54,  7.33s/it]epoch:  28%|██▊       | 28/100 [03:23<08:47,  7.33s/it]epoch:  29%|██▉       | 29/100 [03:31<08:36,  7.28s/it]epoch:  30%|███       | 30/100 [03:38<08:29,  7.29s/it]0.058591034578278876
best ic: 0.058591034578278876
epoch:  31%|███       | 31/100 [03:46<08:46,  7.64s/it]0.06093214820739913
best ic: 0.06093214820739913
epoch:  32%|███▏      | 32/100 [03:55<08:53,  7.85s/it]0.05964547472598239
epoch:  33%|███▎      | 33/100 [04:03<08:54,  7.98s/it]0.05735775554156625
epoch:  34%|███▍      | 34/100 [04:11<08:56,  8.13s/it]0.06464711020748337
best ic: 0.06464711020748337
epoch:  35%|███▌      | 35/100 [04:20<08:50,  8.17s/it]0.056719628613502736
epoch:  36%|███▌      | 36/100 [04:28<08:45,  8.22s/it]0.06186839709137812
epoch:  37%|███▋      | 37/100 [04:36<08:39,  8.25s/it]0.05795195446408468
epoch:  38%|███▊      | 38/100 [04:45<08:31,  8.25s/it]0.05924240211381366
epoch:  39%|███▉      | 39/100 [04:53<08:25,  8.29s/it]0.056800697445730325
epoch:  40%|████      | 40/100 [05:01<08:19,  8.33s/it]0.06101462695793098
epoch:  41%|████      | 41/100 [05:10<08:13,  8.36s/it]0.05711879834345528
epoch:  42%|████▏     | 42/100 [05:18<08:07,  8.40s/it]0.05496045839288837
epoch:  42%|████▏     | 42/100 [05:27<07:31,  7.79s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 20:07:31,020) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 20:07:31,032) INFO - qlib.workflow - [recorder.py:341] - Recorder 1f10a4f4167e43909a41916320f8ca27 starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.06it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.42it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.54it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 17.07it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.72it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.70it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.72it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 17.13it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.84it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.90it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.88it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.80it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.64it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.60it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 16.56it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.51it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.73it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.68it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.51it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.41it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.41it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.88it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.92it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.56it/s]online:  79%|███████▉  | 50/63 [00:02<00:00, 16.55it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.58it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.42it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.34it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.44it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.59it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.67it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.66it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 20:07:47,307) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9964209 mae 0.7075333
{'IC': 0.03601765321449007,
 'ICIR': 0.2632967467218964,
 'Rank IC': 0.034138872222944594,
 'Rank ICIR': 0.25237618187243605}
[2889964:MainThread](2024-04-24 20:07:49,101) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 20:08:01,036) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:08:01,040) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:08:07,038) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa68d38bfd0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  9.03it/s]backtest loop:   1%|          | 10/971 [00:00<00:36, 26.32it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 35.69it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 41.42it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 47.51it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 51.88it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:18, 51.31it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 54.53it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 52.94it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 56.16it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.08it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:15, 56.26it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 58.36it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.70it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 57.50it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 59.22it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 57.16it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.88it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 56.25it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 54.40it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.88it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.76it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 56.16it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:13, 58.15it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:13, 58.55it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 56.33it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 58.02it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 56.05it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 57.79it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 59.47it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 56.56it/s]backtest loop:  22%|██▏       | 212/971 [00:03<00:12, 59.22it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 56.56it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 55.70it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:12, 58.01it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 59.48it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:12, 56.66it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 58.83it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 56.70it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:12, 55.70it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 57.93it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 59.79it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:11, 57.05it/s]backtest loop:  30%|███       | 294/971 [00:05<00:11, 58.83it/s]backtest loop:  31%|███       | 300/971 [00:05<00:11, 56.17it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.94it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 59.59it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 56.55it/s]backtest loop:  34%|███▎      | 327/971 [00:05<00:11, 58.44it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 59.59it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 56.75it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 58.59it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 60.41it/s]backtest loop:  37%|███▋      | 361/971 [00:06<00:10, 58.13it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.73it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.82it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 56.35it/s]backtest loop:  40%|███▉      | 387/971 [00:06<00:10, 58.39it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.67it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.94it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.35it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.63it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 58.71it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 58.89it/s]backtest loop:  44%|████▍     | 432/971 [00:07<00:09, 55.94it/s]backtest loop:  45%|████▌     | 439/971 [00:07<00:09, 57.94it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:09, 58.36it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 56.27it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 58.07it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 59.36it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 55.94it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.75it/s]backtest loop:  50%|█████     | 486/971 [00:08<00:08, 59.29it/s]backtest loop:  51%|█████     | 492/971 [00:08<00:08, 56.39it/s]backtest loop:  51%|█████▏    | 499/971 [00:08<00:08, 58.17it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 56.09it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 55.02it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 57.02it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.50it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.49it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.91it/s]backtest loop:  56%|█████▌    | 546/971 [00:09<00:07, 56.08it/s]backtest loop:  57%|█████▋    | 553/971 [00:09<00:07, 58.12it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 59.56it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.28it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 58.30it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.70it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.33it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.28it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 56.51it/s]backtest loop:  63%|██████▎   | 607/971 [00:10<00:06, 58.27it/s]backtest loop:  63%|██████▎   | 614/971 [00:10<00:05, 59.74it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:06, 57.46it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:05, 59.04it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 57.10it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 58.81it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 60.19it/s]backtest loop:  68%|██████▊   | 656/971 [00:11<00:05, 57.72it/s]backtest loop:  68%|██████▊   | 663/971 [00:11<00:05, 59.23it/s]backtest loop:  69%|██████▉   | 670/971 [00:11<00:05, 57.04it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:08, 34.66it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:07, 40.19it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:06, 42.48it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:05, 47.27it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:05, 51.29it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:05, 50.98it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 54.27it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 56.77it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 54.83it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 53.51it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.29it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.21it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.61it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.30it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.29it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.82it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 58.04it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.54it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.70it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 59.15it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.24it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 58.35it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.72it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.90it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 58.81it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 60.08it/s]backtest loop:  87%|████████▋ | 849/971 [00:15<00:02, 57.40it/s]backtest loop:  88%|████████▊ | 856/971 [00:15<00:01, 58.99it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.13it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.93it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.39it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.49it/s]backtest loop:  92%|█████████▏| 889/971 [00:15<00:01, 58.39it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 59.68it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 56.34it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 58.16it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 56.34it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 58.18it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.49it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 56.72it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 58.61it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 56.49it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 58.22it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.52it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 56.64it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.87it/s]
[2889964:MainThread](2024-04-24 20:08:24,484) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000616
std                0.004860
annualized_return  0.146499
information_ratio  1.953940
max_drawdown      -0.042162
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000419
std                0.004861
annualized_return  0.099652
information_ratio  1.328847
max_drawdown      -0.059689
[2889964:MainThread](2024-04-24 20:08:24,498) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 4 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843,
                                                    0.0808416950970217,
                                                    0.0996519777534036],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686,
                                                    1.0290283224191858,
                                                    1.3288466329341255],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668,
                                               -0.07834368021112156,
                                               -0.059689452422237055],
 'IC': [0.034938309895588854,
        0.0319837277968849,
        0.03141600330561671,
        0.03601765321449007],
 'ICIR': [0.26443813642226155,
          0.2333118121315035,
          0.22755918801990918,
          0.2632967467218964],
 'Rank IC': [0.03540672677594329,
             0.03222908078267821,
             0.031007041976178422,
             0.034138872222944594],
 'Rank ICIR': [0.2681827971385148,
               0.2361252561206688,
               0.22721725134268647,
               0.25237618187243605],
 'mae': [0.7074260711669922,
         0.7075468897819519,
         0.7075085043907166,
         0.7075332999229431],
 'mse': [0.9966168403625488,
         0.9963537454605103,
         0.9966068863868713,
         0.9964209198951721]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 20:08:25,655) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 20:08:25,655) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 20:08:25,657) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 20:08:25,657) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:20,  7.48s/it]epoch:   2%|▏         | 2/100 [00:14<12:00,  7.35s/it]epoch:   3%|▎         | 3/100 [00:21<11:42,  7.24s/it]epoch:   4%|▍         | 4/100 [00:28<11:31,  7.20s/it]epoch:   5%|▌         | 5/100 [00:36<11:26,  7.23s/it]epoch:   6%|▌         | 6/100 [00:43<11:19,  7.23s/it]epoch:   7%|▋         | 7/100 [00:50<11:13,  7.24s/it]epoch:   8%|▊         | 8/100 [00:58<11:08,  7.26s/it]epoch:   9%|▉         | 9/100 [01:05<11:00,  7.25s/it]epoch:  10%|█         | 10/100 [01:12<10:52,  7.25s/it]epoch:  11%|█         | 11/100 [01:19<10:48,  7.28s/it]epoch:  12%|█▏        | 12/100 [01:27<10:43,  7.31s/it]epoch:  13%|█▎        | 13/100 [01:34<10:37,  7.33s/it]epoch:  14%|█▍        | 14/100 [01:41<10:28,  7.31s/it]epoch:  15%|█▌        | 15/100 [01:49<10:18,  7.28s/it]epoch:  16%|█▌        | 16/100 [01:56<10:11,  7.28s/it]epoch:  17%|█▋        | 17/100 [02:03<10:03,  7.27s/it]epoch:  18%|█▊        | 18/100 [02:10<09:57,  7.28s/it]epoch:  19%|█▉        | 19/100 [02:18<09:52,  7.32s/it]epoch:  20%|██        | 20/100 [02:25<09:48,  7.36s/it]epoch:  21%|██        | 21/100 [02:33<09:40,  7.35s/it]epoch:  22%|██▏       | 22/100 [02:40<09:30,  7.31s/it]epoch:  23%|██▎       | 23/100 [02:47<09:22,  7.31s/it]epoch:  24%|██▍       | 24/100 [02:54<09:14,  7.29s/it]epoch:  25%|██▌       | 25/100 [03:02<09:06,  7.29s/it]epoch:  26%|██▌       | 26/100 [03:09<09:00,  7.30s/it]epoch:  27%|██▋       | 27/100 [03:16<08:55,  7.34s/it]epoch:  28%|██▊       | 28/100 [03:24<08:48,  7.33s/it]epoch:  29%|██▉       | 29/100 [03:31<08:39,  7.31s/it]epoch:  30%|███       | 30/100 [03:38<08:27,  7.25s/it]0.05930045042868114
best ic: 0.05930045042868114
epoch:  31%|███       | 31/100 [03:46<08:39,  7.54s/it]0.058614254512737315
epoch:  32%|███▏      | 32/100 [03:55<08:45,  7.73s/it]0.05564406110924691
epoch:  33%|███▎      | 33/100 [04:03<08:50,  7.92s/it]0.0548031815349164
epoch:  34%|███▍      | 34/100 [04:11<08:51,  8.06s/it]0.0554732032642291
epoch:  35%|███▌      | 35/100 [04:20<08:52,  8.20s/it]0.05755703270518217
epoch:  36%|███▌      | 36/100 [04:28<08:46,  8.23s/it]0.0558146548659149
epoch:  37%|███▋      | 37/100 [04:36<08:39,  8.25s/it]0.05309883318227836
epoch:  38%|███▊      | 38/100 [04:45<08:30,  8.23s/it]0.053328773365021766
epoch:  38%|███▊      | 38/100 [04:53<07:58,  7.72s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 20:13:18,959) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 20:13:18,970) INFO - qlib.workflow - [recorder.py:341] - Recorder 821087225fce4c79a6c42e3f859fdfc4 starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.06it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.98it/s]online:  10%|▉         | 6/63 [00:00<00:03, 17.15it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 17.05it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 17.06it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 17.00it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.64it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.86it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.92it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.84it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.96it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.77it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.96it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 17.04it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 17.25it/s]online:  51%|█████     | 32/63 [00:01<00:01, 17.34it/s]online:  54%|█████▍    | 34/63 [00:01<00:01, 17.27it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 17.44it/s]online:  60%|██████    | 38/63 [00:02<00:01, 17.36it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 17.42it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 17.48it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 17.37it/s]online:  73%|███████▎  | 46/63 [00:02<00:00, 17.36it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 17.46it/s]online:  79%|███████▉  | 50/63 [00:02<00:00, 17.49it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 17.39it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 17.21it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 17.11it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 17.17it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 17.11it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 17.20it/s]online: 100%|██████████| 63/63 [00:03<00:00, 17.17it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 20:13:32,777) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99635005 mae 0.7074982
{'IC': 0.03380152540822865,
 'ICIR': 0.2529182417542293,
 'Rank IC': 0.03387218004281943,
 'Rank ICIR': 0.2518726819292428}
[2889964:MainThread](2024-04-24 20:13:34,367) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 20:13:46,525) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:13:46,528) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:13:52,578) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa6632a5ac0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:37,  9.88it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 28.04it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 37.10it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.37it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.45it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:18, 51.63it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:18, 50.74it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 54.15it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 52.82it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 55.71it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 57.92it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.55it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.76it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:15, 57.40it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.17it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.09it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 59.06it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:14, 56.95it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.43it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 55.85it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 53.97it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 56.54it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 58.60it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 55.94it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 58.06it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 58.58it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 56.34it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 58.61it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.77it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.59it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 60.05it/s]backtest loop:  22%|██▏       | 211/971 [00:03<00:13, 57.96it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 55.98it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:12, 57.83it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.14it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.40it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.31it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.46it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.41it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.88it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.55it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:11, 57.77it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 59.25it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.06it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.35it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.56it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 58.68it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:10, 59.95it/s]backtest loop:  34%|███▎      | 326/971 [00:05<00:11, 57.58it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:10, 59.13it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 57.16it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 58.94it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 60.27it/s]backtest loop:  37%|███▋      | 361/971 [00:06<00:10, 58.13it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.73it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.96it/s]backtest loop:  39%|███▉      | 379/971 [00:06<00:10, 55.49it/s]backtest loop:  40%|███▉      | 386/971 [00:06<00:10, 57.58it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 56.05it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 58.15it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.63it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.47it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 58.30it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 59.72it/s]backtest loop:  45%|████▍     | 433/971 [00:07<00:09, 56.42it/s]backtest loop:  45%|████▌     | 440/971 [00:07<00:09, 58.29it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 56.33it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 58.17it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.57it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.57it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 58.45it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.59it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.18it/s]backtest loop:  51%|█████     | 494/971 [00:08<00:08, 58.17it/s]backtest loop:  51%|█████▏    | 500/971 [00:08<00:08, 54.53it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.12it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.78it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.68it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.95it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 58.06it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 56.13it/s]backtest loop:  56%|█████▋    | 547/971 [00:09<00:07, 55.98it/s]backtest loop:  57%|█████▋    | 554/971 [00:09<00:07, 58.20it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.34it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.22it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.67it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:06, 57.29it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 57.82it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.28it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 56.21it/s]backtest loop:  63%|██████▎   | 608/971 [00:10<00:06, 58.13it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:09, 36.94it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:08, 42.27it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:07, 45.94it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:07, 47.90it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:06, 51.67it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 54.65it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 53.11it/s]backtest loop:  68%|██████▊   | 662/971 [00:11<00:05, 55.77it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 57.84it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 55.29it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 56.31it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 58.14it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 55.48it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.69it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 59.25it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 56.13it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 58.05it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.72it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.01it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.41it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.32it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.68it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.28it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.20it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 55.38it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.46it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.21it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.44it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.99it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.10it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.93it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.40it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.38it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 57.25it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.98it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 59.47it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 54.88it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 57.15it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.51it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 57.46it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 58.98it/s]backtest loop:  91%|█████████▏| 887/971 [00:15<00:01, 55.73it/s]backtest loop:  92%|█████████▏| 893/971 [00:16<00:01, 56.40it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 56.84it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 56.59it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.20it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.34it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.81it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.74it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 58.19it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 55.47it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.61it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 57.37it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 55.79it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.76it/s]
[2889964:MainThread](2024-04-24 20:14:10,055) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000764
std                0.004940
annualized_return  0.181933
information_ratio  2.387100
max_drawdown      -0.051859
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000567
std                0.004941
annualized_return  0.135050
information_ratio  1.771562
max_drawdown      -0.066458
[2889964:MainThread](2024-04-24 20:14:10,069) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 5 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843,
                                                    0.0808416950970217,
                                                    0.0996519777534036,
                                                    0.1350500661020691],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686,
                                                    1.0290283224191858,
                                                    1.3288466329341255,
                                                    1.7715617081459447],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668,
                                               -0.07834368021112156,
                                               -0.059689452422237055,
                                               -0.06645825334168459],
 'IC': [0.034938309895588854,
        0.0319837277968849,
        0.03141600330561671,
        0.03601765321449007,
        0.03380152540822865],
 'ICIR': [0.26443813642226155,
          0.2333118121315035,
          0.22755918801990918,
          0.2632967467218964,
          0.2529182417542293],
 'Rank IC': [0.03540672677594329,
             0.03222908078267821,
             0.031007041976178422,
             0.034138872222944594,
             0.03387218004281943],
 'Rank ICIR': [0.2681827971385148,
               0.2361252561206688,
               0.22721725134268647,
               0.25237618187243605,
               0.2518726819292428],
 'mae': [0.7074260711669922,
         0.7075468897819519,
         0.7075085043907166,
         0.7075332999229431,
         0.7074981927871704],
 'mse': [0.9966168403625488,
         0.9963537454605103,
         0.9966068863868713,
         0.9964209198951721,
         0.9963500499725342]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 20:14:11,235) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 20:14:11,236) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 20:14:11,237) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 20:14:11,237) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:42,  7.71s/it]epoch:   2%|▏         | 2/100 [00:14<11:59,  7.35s/it]epoch:   3%|▎         | 3/100 [00:21<11:43,  7.25s/it]epoch:   4%|▍         | 4/100 [00:29<11:33,  7.23s/it]epoch:   5%|▌         | 5/100 [00:36<11:30,  7.27s/it]epoch:   6%|▌         | 6/100 [00:43<11:21,  7.25s/it]epoch:   7%|▋         | 7/100 [00:50<11:09,  7.20s/it]epoch:   8%|▊         | 8/100 [00:58<11:03,  7.21s/it]epoch:   9%|▉         | 9/100 [01:05<10:55,  7.21s/it]epoch:  10%|█         | 10/100 [01:12<10:45,  7.17s/it]epoch:  11%|█         | 11/100 [01:19<10:40,  7.20s/it]epoch:  12%|█▏        | 12/100 [01:26<10:37,  7.24s/it]epoch:  13%|█▎        | 13/100 [01:34<10:29,  7.23s/it]epoch:  14%|█▍        | 14/100 [01:41<10:19,  7.20s/it]epoch:  15%|█▌        | 15/100 [01:48<10:10,  7.18s/it]epoch:  16%|█▌        | 16/100 [01:55<10:03,  7.19s/it]epoch:  17%|█▋        | 17/100 [02:02<09:51,  7.13s/it]epoch:  18%|█▊        | 18/100 [02:09<09:41,  7.09s/it]epoch:  19%|█▉        | 19/100 [02:16<09:39,  7.15s/it]epoch:  20%|██        | 20/100 [02:24<09:33,  7.17s/it]epoch:  21%|██        | 21/100 [02:31<09:24,  7.15s/it]epoch:  22%|██▏       | 22/100 [02:38<09:18,  7.16s/it]epoch:  23%|██▎       | 23/100 [02:45<09:13,  7.19s/it]epoch:  24%|██▍       | 24/100 [02:52<09:05,  7.18s/it]epoch:  25%|██▌       | 25/100 [02:59<08:54,  7.13s/it]epoch:  26%|██▌       | 26/100 [03:07<08:49,  7.16s/it]epoch:  27%|██▋       | 27/100 [03:14<08:47,  7.23s/it]epoch:  28%|██▊       | 28/100 [03:21<08:45,  7.30s/it]epoch:  29%|██▉       | 29/100 [03:29<08:36,  7.27s/it]epoch:  30%|███       | 30/100 [03:36<08:25,  7.23s/it]0.06440096825661447
best ic: 0.06440096825661447
epoch:  31%|███       | 31/100 [03:44<08:42,  7.57s/it]0.06256738374182355
epoch:  32%|███▏      | 32/100 [03:52<08:49,  7.79s/it]0.06141183360943072
epoch:  33%|███▎      | 33/100 [04:01<08:51,  7.94s/it]0.06187392873125665
epoch:  34%|███▍      | 34/100 [04:09<08:52,  8.07s/it]0.05697883189441806
epoch:  35%|███▌      | 35/100 [04:18<08:52,  8.18s/it]0.058460850109121644
epoch:  36%|███▌      | 36/100 [04:26<08:46,  8.23s/it]0.06010923725670766
epoch:  37%|███▋      | 37/100 [04:34<08:38,  8.22s/it]0.060403122790209235
epoch:  38%|███▊      | 38/100 [04:42<08:31,  8.25s/it]0.06016736416729048
epoch:  38%|███▊      | 38/100 [04:51<07:55,  7.67s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 20:19:02,536) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 20:19:02,548) INFO - qlib.workflow - [recorder.py:341] - Recorder 02d2f4b2a0fa4aa3a2d36f60bc596577 starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.44it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.78it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.55it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.52it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.56it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.77it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.82it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.55it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.82it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.80it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.87it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.78it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.64it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.81it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 16.78it/s]online:  51%|█████     | 32/63 [00:01<00:01, 17.13it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 17.01it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 17.20it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.84it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.82it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 17.02it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 17.00it/s]online:  73%|███████▎  | 46/63 [00:02<00:00, 17.05it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 17.00it/s]online:  79%|███████▉  | 50/63 [00:02<00:00, 16.87it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.78it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.77it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.71it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.93it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.80it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.92it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.86it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 20:19:15,854) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99632794 mae 0.7074288
{'IC': 0.03338627558833016,
 'ICIR': 0.23438551738157165,
 'Rank IC': 0.0337131091887525,
 'Rank ICIR': 0.2399643053036326}
[2889964:MainThread](2024-04-24 20:19:17,557) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 20:19:29,759) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:19:29,762) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:19:35,834) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa687098f70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:48,  8.93it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 24.00it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.70it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.90it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.11it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.06it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:18, 51.61it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:17, 53.90it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.37it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.09it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.51it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.89it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.65it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.01it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:15, 57.06it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.36it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 56.72it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 55.38it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 57.50it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.32it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.67it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.35it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.19it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.00it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 55.47it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:14, 57.59it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 57.43it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.11it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 57.39it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 55.74it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 57.68it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.28it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.65it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.38it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.64it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.59it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.64it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.10it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 55.90it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 57.95it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.42it/s]backtest loop:  28%|██▊       | 270/971 [00:05<00:12, 56.66it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 54.49it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.82it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.24it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.35it/s]backtest loop:  31%|███       | 301/971 [00:05<00:11, 56.59it/s]backtest loop:  32%|███▏      | 308/971 [00:05<00:11, 58.53it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 58.83it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 55.94it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 58.13it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 59.66it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 56.69it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 58.71it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.94it/s]backtest loop:  37%|███▋      | 361/971 [00:06<00:10, 57.35it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.24it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.68it/s]backtest loop:  39%|███▉      | 379/971 [00:06<00:10, 55.34it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 57.47it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.86it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.70it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 58.04it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.11it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 57.91it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 57.70it/s]backtest loop:  44%|████▍     | 432/971 [00:07<00:09, 55.08it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 57.23it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:08, 58.76it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 55.64it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 56.65it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 57.56it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.27it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.14it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 57.90it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.25it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 57.36it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 58.98it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.05it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 55.05it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.20it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.72it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.81it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.06it/s]backtest loop:  57%|█████▋    | 551/971 [00:09<00:07, 56.15it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.88it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.01it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.09it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.92it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.49it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 55.97it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 58.01it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 56.25it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 57.11it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:10, 33.25it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:09, 37.89it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:08, 41.66it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:07, 46.70it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:06, 50.65it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:06, 50.34it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 53.66it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 56.16it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 54.20it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 56.59it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:05, 57.42it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 54.47it/s]backtest loop:  72%|███████▏  | 695/971 [00:12<00:04, 55.80it/s]backtest loop:  72%|███████▏  | 702/971 [00:12<00:04, 57.83it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:04, 56.08it/s]backtest loop:  74%|███████▎  | 715/971 [00:13<00:04, 57.07it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.76it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.75it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.76it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.97it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.25it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.61it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.13it/s]backtest loop:  79%|███████▉  | 769/971 [00:14<00:03, 57.97it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.62it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.90it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.53it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.45it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:02, 58.12it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 57.29it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 53.99it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 56.53it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 58.54it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.84it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.87it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 59.26it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 55.05it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 57.15it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 57.67it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 54.25it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 56.68it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 58.47it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 55.75it/s]backtest loop:  92%|█████████▏| 898/971 [00:16<00:01, 56.62it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 58.33it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.42it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.20it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.33it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 58.14it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 56.30it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 58.10it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 58.52it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 56.38it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 55.96it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.11it/s]
[2889964:MainThread](2024-04-24 20:19:53,519) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000562
std                0.005479
annualized_return  0.133643
information_ratio  1.581153
max_drawdown      -0.089845
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000364
std                0.005479
annualized_return  0.086735
information_ratio  1.026102
max_drawdown      -0.102584
[2889964:MainThread](2024-04-24 20:19:53,534) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 6 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843,
                                                    0.0808416950970217,
                                                    0.0996519777534036,
                                                    0.1350500661020691,
                                                    0.08673549373228509],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686,
                                                    1.0290283224191858,
                                                    1.3288466329341255,
                                                    1.7715617081459447,
                                                    1.0261021848895757],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668,
                                               -0.07834368021112156,
                                               -0.059689452422237055,
                                               -0.06645825334168459,
                                               -0.10258366610555786],
 'IC': [0.034938309895588854,
        0.0319837277968849,
        0.03141600330561671,
        0.03601765321449007,
        0.03380152540822865,
        0.03338627558833016],
 'ICIR': [0.26443813642226155,
          0.2333118121315035,
          0.22755918801990918,
          0.2632967467218964,
          0.2529182417542293,
          0.23438551738157165],
 'Rank IC': [0.03540672677594329,
             0.03222908078267821,
             0.031007041976178422,
             0.034138872222944594,
             0.03387218004281943,
             0.0337131091887525],
 'Rank ICIR': [0.2681827971385148,
               0.2361252561206688,
               0.22721725134268647,
               0.25237618187243605,
               0.2518726819292428,
               0.2399643053036326],
 'mae': [0.7074260711669922,
         0.7075468897819519,
         0.7075085043907166,
         0.7075332999229431,
         0.7074981927871704,
         0.7074288129806519],
 'mse': [0.9966168403625488,
         0.9963537454605103,
         0.9966068863868713,
         0.9964209198951721,
         0.9963500499725342,
         0.9963279366493225]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 20:19:54,698) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 20:19:54,698) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 20:19:54,699) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 20:19:54,700) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:38,  7.66s/it]epoch:   2%|▏         | 2/100 [00:14<12:04,  7.40s/it]epoch:   3%|▎         | 3/100 [00:22<11:57,  7.39s/it]epoch:   4%|▍         | 4/100 [00:29<11:50,  7.40s/it]epoch:   5%|▌         | 5/100 [00:37<11:41,  7.38s/it]epoch:   6%|▌         | 6/100 [00:44<11:26,  7.31s/it]epoch:   7%|▋         | 7/100 [00:51<11:17,  7.29s/it]epoch:   8%|▊         | 8/100 [00:58<11:09,  7.28s/it]epoch:   9%|▉         | 9/100 [01:05<10:59,  7.24s/it]epoch:  10%|█         | 10/100 [01:12<10:46,  7.18s/it]epoch:  11%|█         | 11/100 [01:20<10:40,  7.19s/it]epoch:  12%|█▏        | 12/100 [01:27<10:38,  7.25s/it]epoch:  13%|█▎        | 13/100 [01:34<10:24,  7.18s/it]epoch:  14%|█▍        | 14/100 [01:41<10:13,  7.14s/it]epoch:  15%|█▌        | 15/100 [01:48<10:09,  7.18s/it]epoch:  16%|█▌        | 16/100 [01:56<10:04,  7.19s/it]epoch:  17%|█▋        | 17/100 [02:03<09:57,  7.19s/it]epoch:  18%|█▊        | 18/100 [02:10<09:54,  7.25s/it]epoch:  19%|█▉        | 19/100 [02:17<09:46,  7.24s/it]epoch:  20%|██        | 20/100 [02:25<09:40,  7.25s/it]epoch:  21%|██        | 21/100 [02:32<09:27,  7.18s/it]epoch:  22%|██▏       | 22/100 [02:39<09:21,  7.20s/it]epoch:  23%|██▎       | 23/100 [02:46<09:16,  7.22s/it]epoch:  24%|██▍       | 24/100 [02:53<09:08,  7.22s/it]epoch:  25%|██▌       | 25/100 [03:01<09:03,  7.25s/it]epoch:  26%|██▌       | 26/100 [03:08<08:58,  7.28s/it]epoch:  27%|██▋       | 27/100 [03:15<08:52,  7.30s/it]epoch:  28%|██▊       | 28/100 [03:23<08:45,  7.30s/it]epoch:  29%|██▉       | 29/100 [03:30<08:36,  7.27s/it]epoch:  30%|███       | 30/100 [03:37<08:24,  7.21s/it]0.05755457086358566
best ic: 0.05755457086358566
epoch:  31%|███       | 31/100 [03:45<08:40,  7.55s/it]0.06092320615392578
best ic: 0.06092320615392578
epoch:  32%|███▏      | 32/100 [03:54<08:48,  7.77s/it]0.061988765566622896
best ic: 0.061988765566622896
epoch:  33%|███▎      | 33/100 [04:02<08:52,  7.95s/it]0.057024888307423076
epoch:  34%|███▍      | 34/100 [04:10<08:53,  8.08s/it]0.05964783837369453
epoch:  35%|███▌      | 35/100 [04:19<08:49,  8.15s/it]0.060121592744371434
epoch:  36%|███▌      | 36/100 [04:27<08:42,  8.16s/it]0.05743611348543778
epoch:  37%|███▋      | 37/100 [04:35<08:33,  8.16s/it]0.06021063145556035
epoch:  38%|███▊      | 38/100 [04:43<08:28,  8.19s/it]0.05796185331867572
epoch:  39%|███▉      | 39/100 [04:51<08:20,  8.20s/it]0.061165961115336814
epoch:  40%|████      | 40/100 [05:00<08:13,  8.22s/it]0.05566837282793775
epoch:  40%|████      | 40/100 [05:08<07:43,  7.72s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 20:25:03,460) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 20:25:03,472) INFO - qlib.workflow - [recorder.py:341] - Recorder ee712237a84846358acef0365fa995ff starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.05it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.34it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.48it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.71it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.74it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.63it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.71it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.57it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.48it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.57it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.36it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.65it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.59it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.60it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 16.49it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.63it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.63it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.53it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.60it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.57it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.82it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.69it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.63it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.71it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.70it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.71it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.74it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 17.00it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 17.18it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 17.32it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 17.28it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.77it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 20:25:16,724) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.996643 mae 0.7075016
{'IC': 0.03214986770435822,
 'ICIR': 0.23491928754221703,
 'Rank IC': 0.030943839617321976,
 'Rank ICIR': 0.23063933725249786}
[2889964:MainThread](2024-04-24 20:25:18,420) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 20:25:30,567) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:25:30,570) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:25:36,591) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa66417ea30>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.19it/s]backtest loop:   1%|          | 10/971 [00:00<00:36, 26.68it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 35.94it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 41.56it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 47.90it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 52.23it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.53it/s]backtest loop:   5%|▌         | 50/971 [00:01<00:17, 53.45it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.17it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 56.52it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.76it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:15, 55.99it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 58.09it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.60it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 57.58it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 59.15it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.87it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.59it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.98it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 54.14it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.65it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.60it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.95it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.95it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 59.40it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 56.57it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:13, 57.38it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 59.12it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.24it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.32it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.74it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.75it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.94it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 57.33it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.99it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.75it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.35it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.28it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.24it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.48it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 55.12it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.21it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.79it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.03it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.06it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.34it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 58.26it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:10, 59.84it/s]backtest loop:  34%|███▎      | 326/971 [00:05<00:11, 57.49it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:10, 59.28it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 57.34it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 59.10it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 60.71it/s]backtest loop:  37%|███▋      | 361/971 [00:06<00:10, 58.03it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.59it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 54.06it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 56.60it/s]backtest loop:  40%|███▉      | 387/971 [00:06<00:09, 58.47it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.85it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 58.01it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.49it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.59it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 58.37it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 59.71it/s]backtest loop:  45%|████▍     | 433/971 [00:07<00:09, 56.54it/s]backtest loop:  45%|████▌     | 440/971 [00:07<00:09, 58.33it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 56.38it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 58.16it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.38it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.39it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 58.16it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.38it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.24it/s]backtest loop:  51%|█████     | 494/971 [00:08<00:08, 58.06it/s]backtest loop:  51%|█████▏    | 500/971 [00:08<00:08, 55.31it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.54it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.94it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.71it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.86it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.92it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 56.15it/s]backtest loop:  56%|█████▋    | 547/971 [00:09<00:07, 57.14it/s]backtest loop:  57%|█████▋    | 554/971 [00:09<00:07, 58.89it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.67it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.38it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.72it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:06, 57.57it/s]backtest loop:  61%|██████    | 589/971 [00:10<00:06, 59.06it/s]backtest loop:  61%|██████▏   | 596/971 [00:10<00:06, 56.93it/s]backtest loop:  62%|██████▏   | 603/971 [00:10<00:06, 58.52it/s]backtest loop:  63%|██████▎   | 610/971 [00:10<00:06, 56.35it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:09, 36.68it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:08, 42.04it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:07, 44.83it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:06, 49.17it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:06, 52.68it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:06, 52.00it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 54.77it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 56.97it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 54.83it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.09it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 57.85it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.33it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.50it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 59.16it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 56.35it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 58.35it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.57it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.64it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.78it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 57.16it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.83it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:03, 54.09it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.64it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.43it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 56.05it/s]backtest loop:  80%|████████  | 781/971 [00:14<00:03, 57.09it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.71it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.76it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 59.20it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.30it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 58.12it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.52it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.49it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 58.33it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.71it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.23it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.43it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.64it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 58.39it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.75it/s]backtest loop:  91%|█████████ | 883/971 [00:15<00:01, 57.53it/s]backtest loop:  92%|█████████▏| 890/971 [00:15<00:01, 59.07it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 57.03it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 58.74it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:00, 60.02it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:00, 57.59it/s]backtest loop:  95%|█████████▌| 925/971 [00:16<00:00, 59.11it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.33it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.19it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 56.37it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 58.45it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.52it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.41it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 57.36it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.94it/s]
[2889964:MainThread](2024-04-24 20:25:54,014) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000452
std                0.005092
annualized_return  0.107636
information_ratio  1.370074
max_drawdown      -0.068087
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000255
std                0.005093
annualized_return  0.060649
information_ratio  0.771966
max_drawdown      -0.075255
[2889964:MainThread](2024-04-24 20:25:54,028) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 7 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843,
                                                    0.0808416950970217,
                                                    0.0996519777534036,
                                                    0.1350500661020691,
                                                    0.08673549373228509,
                                                    0.06064898958727187],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686,
                                                    1.0290283224191858,
                                                    1.3288466329341255,
                                                    1.7715617081459447,
                                                    1.0261021848895757,
                                                    0.771966296022316],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668,
                                               -0.07834368021112156,
                                               -0.059689452422237055,
                                               -0.06645825334168459,
                                               -0.10258366610555786,
                                               -0.07525497703661124],
 'IC': [0.034938309895588854,
        0.0319837277968849,
        0.03141600330561671,
        0.03601765321449007,
        0.03380152540822865,
        0.03338627558833016,
        0.03214986770435822],
 'ICIR': [0.26443813642226155,
          0.2333118121315035,
          0.22755918801990918,
          0.2632967467218964,
          0.2529182417542293,
          0.23438551738157165,
          0.23491928754221703],
 'Rank IC': [0.03540672677594329,
             0.03222908078267821,
             0.031007041976178422,
             0.034138872222944594,
             0.03387218004281943,
             0.0337131091887525,
             0.030943839617321976],
 'Rank ICIR': [0.2681827971385148,
               0.2361252561206688,
               0.22721725134268647,
               0.25237618187243605,
               0.2518726819292428,
               0.2399643053036326,
               0.23063933725249786],
 'mae': [0.7074260711669922,
         0.7075468897819519,
         0.7075085043907166,
         0.7075332999229431,
         0.7074981927871704,
         0.7074288129806519,
         0.7075015902519226],
 'mse': [0.9966168403625488,
         0.9963537454605103,
         0.9966068863868713,
         0.9964209198951721,
         0.9963500499725342,
         0.9963279366493225,
         0.9966430068016052]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 20:25:55,187) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 20:25:55,187) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 20:25:55,189) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 20:25:55,189) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<11:56,  7.24s/it]epoch:   2%|▏         | 2/100 [00:14<11:52,  7.28s/it]epoch:   3%|▎         | 3/100 [00:21<11:44,  7.26s/it]epoch:   4%|▍         | 4/100 [00:28<11:32,  7.21s/it]epoch:   5%|▌         | 5/100 [00:36<11:26,  7.23s/it]epoch:   6%|▌         | 6/100 [00:43<11:14,  7.17s/it]epoch:   7%|▋         | 7/100 [00:50<11:14,  7.25s/it]epoch:   8%|▊         | 8/100 [00:58<11:11,  7.30s/it]epoch:   9%|▉         | 9/100 [01:05<11:04,  7.30s/it]epoch:  10%|█         | 10/100 [01:12<10:55,  7.29s/it]epoch:  11%|█         | 11/100 [01:19<10:46,  7.27s/it]epoch:  12%|█▏        | 12/100 [01:27<10:37,  7.24s/it]epoch:  13%|█▎        | 13/100 [01:34<10:30,  7.24s/it]epoch:  14%|█▍        | 14/100 [01:41<10:26,  7.29s/it]epoch:  15%|█▌        | 15/100 [01:49<10:23,  7.33s/it]epoch:  16%|█▌        | 16/100 [01:56<10:16,  7.34s/it]epoch:  17%|█▋        | 17/100 [02:03<10:06,  7.31s/it]epoch:  18%|█▊        | 18/100 [02:10<09:57,  7.28s/it]epoch:  19%|█▉        | 19/100 [02:18<09:49,  7.28s/it]epoch:  20%|██        | 20/100 [02:25<09:40,  7.25s/it]epoch:  21%|██        | 21/100 [02:32<09:32,  7.25s/it]epoch:  22%|██▏       | 22/100 [02:39<09:25,  7.25s/it]epoch:  23%|██▎       | 23/100 [02:47<09:23,  7.31s/it]epoch:  24%|██▍       | 24/100 [02:54<09:15,  7.31s/it]epoch:  25%|██▌       | 25/100 [03:01<09:07,  7.29s/it]epoch:  26%|██▌       | 26/100 [03:09<08:59,  7.29s/it]epoch:  27%|██▋       | 27/100 [03:16<08:51,  7.29s/it]epoch:  28%|██▊       | 28/100 [03:23<08:44,  7.28s/it]epoch:  29%|██▉       | 29/100 [03:30<08:35,  7.27s/it]epoch:  30%|███       | 30/100 [03:38<08:30,  7.29s/it]0.05976515523946111
best ic: 0.05976515523946111
epoch:  31%|███       | 31/100 [03:46<08:49,  7.68s/it]0.059829821369917796
best ic: 0.059829821369917796
epoch:  32%|███▏      | 32/100 [03:55<08:54,  7.86s/it]0.05852993274841374
epoch:  33%|███▎      | 33/100 [04:03<08:53,  7.96s/it]0.05938230675141813
epoch:  34%|███▍      | 34/100 [04:11<08:49,  8.02s/it]0.058971882895720924
epoch:  35%|███▌      | 35/100 [04:19<08:43,  8.05s/it]0.05818109065269445
epoch:  36%|███▌      | 36/100 [04:27<08:40,  8.13s/it]0.05506500395152818
epoch:  37%|███▋      | 37/100 [04:36<08:35,  8.18s/it]0.05550318708933021
epoch:  38%|███▊      | 38/100 [04:44<08:31,  8.25s/it]0.056813018880656214
epoch:  39%|███▉      | 39/100 [04:52<08:21,  8.22s/it]0.06006067383863299
best ic: 0.06006067383863299
epoch:  40%|████      | 40/100 [05:01<08:12,  8.21s/it]0.05911367393084686
epoch:  41%|████      | 41/100 [05:09<08:04,  8.20s/it]0.05499073210488644
epoch:  42%|████▏     | 42/100 [05:17<07:56,  8.22s/it]0.05708825966650264
epoch:  43%|████▎     | 43/100 [05:25<07:49,  8.24s/it]0.05487347552150978
epoch:  44%|████▍     | 44/100 [05:34<07:41,  8.24s/it]0.05224105294301154
epoch:  45%|████▌     | 45/100 [05:42<07:36,  8.30s/it]0.05586981492380363
epoch:  46%|████▌     | 46/100 [05:50<07:28,  8.31s/it]0.05527208840210477
epoch:  47%|████▋     | 47/100 [05:58<07:18,  8.27s/it]0.05169043613465113
epoch:  47%|████▋     | 47/100 [06:07<06:54,  7.81s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 20:32:02,493) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 20:32:02,504) INFO - qlib.workflow - [recorder.py:341] - Recorder e12d39de7a384029bf9d019745a39d45 starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.53it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.81it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.86it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.60it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.69it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.65it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.92it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.63it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.70it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.76it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.81it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.67it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.69it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.54it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 16.67it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.60it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.62it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 17.04it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.93it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.88it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 17.00it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.88it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.91it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.90it/s]online:  79%|███████▉  | 50/63 [00:02<00:00, 16.79it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.94it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.47it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.73it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.45it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.51it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.47it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.75it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 20:32:15,536) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99669534 mae 0.70747507
{'IC': 0.03597586118951254,
 'ICIR': 0.27962096857224755,
 'Rank IC': 0.03558015813347795,
 'Rank ICIR': 0.2773735721980436}
[2889964:MainThread](2024-04-24 20:32:17,216) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 20:32:29,388) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:32:29,391) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:32:35,377) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa6861ab490>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.56it/s]backtest loop:   1%|          | 10/971 [00:00<00:35, 27.39it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 36.56it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.04it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.12it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 52.54it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.88it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 55.27it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.35it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 56.17it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.37it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:15, 55.89it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 58.03it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.67it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 57.24it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 58.69it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 58.74it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.03it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.18it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 55.51it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 54.01it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 56.63it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 58.59it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 55.91it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 58.02it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 59.66it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:13, 56.83it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 58.81it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.61it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.69it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 60.33it/s]backtest loop:  22%|██▏       | 211/971 [00:03<00:13, 58.25it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 55.89it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:12, 58.11it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.85it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 58.04it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.72it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.62it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.53it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.86it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.29it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:12, 56.30it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:11, 58.24it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.44it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.53it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.76it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 58.81it/s]backtest loop:  33%|███▎      | 318/971 [00:05<00:11, 58.76it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.93it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 59.07it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 60.51it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.94it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 59.61it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 57.47it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 56.04it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 54.36it/s]backtest loop:  39%|███▉      | 379/971 [00:06<00:10, 55.77it/s]backtest loop:  40%|███▉      | 386/971 [00:06<00:10, 57.94it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 56.45it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 58.36it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.78it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:09, 57.62it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:09, 59.18it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 57.11it/s]backtest loop:  45%|████▍     | 435/971 [00:07<00:09, 58.77it/s]backtest loop:  45%|████▌     | 441/971 [00:07<00:08, 59.06it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 56.31it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 58.06it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.42it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.24it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 58.49it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.87it/s]backtest loop:  50%|█████     | 488/971 [00:08<00:08, 57.47it/s]backtest loop:  51%|█████     | 495/971 [00:08<00:08, 56.02it/s]backtest loop:  52%|█████▏    | 502/971 [00:08<00:08, 57.82it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.91it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:07, 57.97it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:07, 56.30it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 58.17it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 56.54it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 58.32it/s]backtest loop:  57%|█████▋    | 550/971 [00:09<00:07, 59.77it/s]backtest loop:  57%|█████▋    | 557/971 [00:09<00:07, 57.77it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:06, 59.03it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 57.13it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.52it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 60.00it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 57.66it/s]backtest loop:  62%|██████▏   | 599/971 [00:10<00:06, 59.37it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 56.41it/s]backtest loop:  63%|██████▎   | 612/971 [00:10<00:06, 58.39it/s]backtest loop:  64%|██████▎   | 619/971 [00:10<00:05, 60.03it/s]backtest loop:  64%|██████▍   | 626/971 [00:11<00:05, 57.56it/s]backtest loop:  65%|██████▌   | 633/971 [00:11<00:05, 59.17it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 57.51it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 59.13it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 60.27it/s]backtest loop:  68%|██████▊   | 661/971 [00:11<00:05, 57.85it/s]backtest loop:  69%|██████▉   | 668/971 [00:11<00:05, 59.29it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:08, 35.75it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:07, 41.23it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:06, 46.06it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:05, 47.06it/s]backtest loop:  72%|███████▏  | 700/971 [00:12<00:05, 50.08it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 53.67it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 53.47it/s]backtest loop:  74%|███████▍  | 721/971 [00:12<00:04, 56.18it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 58.24it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.34it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 56.06it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.93it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:03, 54.23it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.71it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.58it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 55.99it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 58.06it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.45it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.45it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:02, 57.77it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.14it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 58.26it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.67it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.69it/s]backtest loop:  86%|████████▌ | 835/971 [00:14<00:02, 58.56it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.89it/s]backtest loop:  87%|████████▋ | 849/971 [00:15<00:02, 57.52it/s]backtest loop:  88%|████████▊ | 856/971 [00:15<00:01, 59.28it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.16it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 58.19it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.71it/s]backtest loop:  91%|█████████ | 883/971 [00:15<00:01, 57.49it/s]backtest loop:  92%|█████████▏| 890/971 [00:15<00:01, 59.11it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 57.17it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 58.93it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:00, 60.29it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:00, 57.92it/s]backtest loop:  95%|█████████▌| 925/971 [00:16<00:00, 59.17it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.34it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.38it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 56.67it/s]backtest loop:  98%|█████████▊| 952/971 [00:16<00:00, 58.61it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.99it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 57.58it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.17it/s]
[2889964:MainThread](2024-04-24 20:32:52,728) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000629
std                0.004972
annualized_return  0.149597
information_ratio  1.950226
max_drawdown      -0.086567
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000432
std                0.004973
annualized_return  0.102721
information_ratio  1.338840
max_drawdown      -0.100956
[2889964:MainThread](2024-04-24 20:32:52,742) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 8 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843,
                                                    0.0808416950970217,
                                                    0.0996519777534036,
                                                    0.1350500661020691,
                                                    0.08673549373228509,
                                                    0.06064898958727187,
                                                    0.10272142829551463],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686,
                                                    1.0290283224191858,
                                                    1.3288466329341255,
                                                    1.7715617081459447,
                                                    1.0261021848895757,
                                                    0.771966296022316,
                                                    1.3388396010553556],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668,
                                               -0.07834368021112156,
                                               -0.059689452422237055,
                                               -0.06645825334168459,
                                               -0.10258366610555786,
                                               -0.07525497703661124,
                                               -0.100956308901751],
 'IC': [0.034938309895588854,
        0.0319837277968849,
        0.03141600330561671,
        0.03601765321449007,
        0.03380152540822865,
        0.03338627558833016,
        0.03214986770435822,
        0.03597586118951254],
 'ICIR': [0.26443813642226155,
          0.2333118121315035,
          0.22755918801990918,
          0.2632967467218964,
          0.2529182417542293,
          0.23438551738157165,
          0.23491928754221703,
          0.27962096857224755],
 'Rank IC': [0.03540672677594329,
             0.03222908078267821,
             0.031007041976178422,
             0.034138872222944594,
             0.03387218004281943,
             0.0337131091887525,
             0.030943839617321976,
             0.03558015813347795],
 'Rank ICIR': [0.2681827971385148,
               0.2361252561206688,
               0.22721725134268647,
               0.25237618187243605,
               0.2518726819292428,
               0.2399643053036326,
               0.23063933725249786,
               0.2773735721980436],
 'mae': [0.7074260711669922,
         0.7075468897819519,
         0.7075085043907166,
         0.7075332999229431,
         0.7074981927871704,
         0.7074288129806519,
         0.7075015902519226,
         0.7074750661849976],
 'mse': [0.9966168403625488,
         0.9963537454605103,
         0.9966068863868713,
         0.9964209198951721,
         0.9963500499725342,
         0.9963279366493225,
         0.9966430068016052,
         0.996695339679718]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 20:32:53,895) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 20:32:53,895) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 20:32:53,897) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 20:32:53,897) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:34,  7.63s/it]epoch:   2%|▏         | 2/100 [00:14<12:06,  7.42s/it]epoch:   3%|▎         | 3/100 [00:22<11:45,  7.27s/it]epoch:   4%|▍         | 4/100 [00:29<11:39,  7.29s/it]epoch:   5%|▌         | 5/100 [00:36<11:36,  7.33s/it]epoch:   6%|▌         | 6/100 [00:44<11:29,  7.34s/it]epoch:   7%|▋         | 7/100 [00:51<11:19,  7.30s/it]epoch:   8%|▊         | 8/100 [00:58<11:04,  7.22s/it]epoch:   9%|▉         | 9/100 [01:05<10:53,  7.18s/it]epoch:  10%|█         | 10/100 [01:12<10:46,  7.18s/it]epoch:  11%|█         | 11/100 [01:19<10:41,  7.21s/it]epoch:  12%|█▏        | 12/100 [01:27<10:38,  7.26s/it]epoch:  13%|█▎        | 13/100 [01:34<10:36,  7.32s/it]epoch:  14%|█▍        | 14/100 [01:41<10:26,  7.29s/it]epoch:  15%|█▌        | 15/100 [01:49<10:18,  7.28s/it]epoch:  16%|█▌        | 16/100 [01:56<10:10,  7.27s/it]epoch:  17%|█▋        | 17/100 [02:03<10:03,  7.27s/it]epoch:  18%|█▊        | 18/100 [02:10<09:51,  7.22s/it]epoch:  19%|█▉        | 19/100 [02:17<09:43,  7.20s/it]epoch:  20%|██        | 20/100 [02:25<09:38,  7.23s/it]epoch:  21%|██        | 21/100 [02:32<09:36,  7.30s/it]epoch:  22%|██▏       | 22/100 [02:39<09:27,  7.27s/it]epoch:  23%|██▎       | 23/100 [02:47<09:20,  7.28s/it]epoch:  24%|██▍       | 24/100 [02:54<09:12,  7.27s/it]epoch:  25%|██▌       | 25/100 [03:01<09:04,  7.26s/it]epoch:  26%|██▌       | 26/100 [03:08<08:57,  7.26s/it]epoch:  27%|██▋       | 27/100 [03:16<08:53,  7.32s/it]epoch:  28%|██▊       | 28/100 [03:23<08:49,  7.36s/it]epoch:  29%|██▉       | 29/100 [03:31<08:40,  7.33s/it]epoch:  30%|███       | 30/100 [03:38<08:31,  7.30s/it]0.06159754806683871
best ic: 0.06159754806683871
epoch:  31%|███       | 31/100 [03:46<08:43,  7.59s/it]0.05867483304284278
epoch:  32%|███▏      | 32/100 [03:54<08:51,  7.82s/it]0.06352495001733283
best ic: 0.06352495001733283
epoch:  33%|███▎      | 33/100 [04:03<08:54,  7.97s/it]0.05764488306072707
epoch:  34%|███▍      | 34/100 [04:11<08:53,  8.08s/it]0.05954758327911198
epoch:  35%|███▌      | 35/100 [04:20<08:53,  8.21s/it]0.06150812241468118
epoch:  36%|███▌      | 36/100 [04:28<08:42,  8.16s/it]0.06257930436606489
epoch:  37%|███▋      | 37/100 [04:36<08:31,  8.12s/it]0.059629146163248097
epoch:  38%|███▊      | 38/100 [04:44<08:25,  8.15s/it]0.06015546962691099
epoch:  39%|███▉      | 39/100 [04:52<08:17,  8.15s/it]0.05967258734719545
epoch:  40%|████      | 40/100 [05:00<08:09,  8.16s/it]0.05637680860261325
epoch:  40%|████      | 40/100 [05:09<07:43,  7.73s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 20:38:03,004) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 20:38:03,015) INFO - qlib.workflow - [recorder.py:341] - Recorder 6120dbdbba484cd08a859632538cd81b starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 17.75it/s]online:   6%|▋         | 4/63 [00:00<00:03, 17.41it/s]online:  10%|▉         | 6/63 [00:00<00:03, 17.10it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 17.30it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.86it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.79it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.75it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.74it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.72it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.80it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.88it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 17.04it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.93it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.82it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 16.78it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.77it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.70it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 17.01it/s]online:  60%|██████    | 38/63 [00:02<00:01, 17.12it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 17.00it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.79it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.76it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.73it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.63it/s]online:  79%|███████▉  | 50/63 [00:02<00:00, 16.94it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.99it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 17.09it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 17.25it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 17.30it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 17.39it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 17.30it/s]online: 100%|██████████| 63/63 [00:03<00:00, 17.00it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 20:38:15,373) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99661463 mae 0.70768356
{'IC': 0.032964882175772085,
 'ICIR': 0.2519853372930829,
 'Rank IC': 0.0334892818005265,
 'Rank ICIR': 0.2583934641320263}
[2889964:MainThread](2024-04-24 20:38:17,079) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 20:38:29,611) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:38:29,614) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:38:35,734) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa6ad79d430>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  9.04it/s]backtest loop:   1%|          | 10/971 [00:00<00:36, 26.38it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 35.73it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 41.38it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:20, 45.03it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:18, 50.24it/s]backtest loop:   4%|▍         | 43/971 [00:01<00:17, 52.34it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 51.49it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 54.83it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:17, 53.02it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 56.27it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 58.49it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:16, 55.21it/s]backtest loop:   9%|▉         | 88/971 [00:01<00:15, 56.49it/s]backtest loop:  10%|▉         | 95/971 [00:01<00:14, 58.52it/s]backtest loop:  11%|█         | 102/971 [00:02<00:15, 56.77it/s]backtest loop:  11%|█         | 109/971 [00:02<00:14, 58.53it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 59.90it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:14, 57.44it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:15, 55.06it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 56.15it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.31it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.00it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.63it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.94it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 58.05it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.68it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:13, 56.94it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.88it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.81it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.71it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 60.27it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 55.10it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 57.44it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.93it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.93it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.42it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:12, 57.29it/s]backtest loop:  27%|██▋       | 258/971 [00:04<00:12, 58.96it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.41it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 55.22it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.64it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 59.15it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.48it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.59it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.60it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 58.41it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:10, 59.79it/s]backtest loop:  34%|███▎      | 326/971 [00:05<00:11, 56.94it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:10, 58.86it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 57.28it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.97it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 59.78it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 57.48it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.55it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.80it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 56.30it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 58.16it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.24it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.56it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.20it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.15it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 58.08it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 59.45it/s]backtest loop:  45%|████▍     | 433/971 [00:07<00:09, 56.31it/s]backtest loop:  45%|████▌     | 440/971 [00:07<00:09, 58.21it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 56.32it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 58.16it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.50it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.46it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 57.98it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.23it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.02it/s]backtest loop:  51%|█████     | 494/971 [00:08<00:08, 57.91it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.43it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.40it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.79it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.48it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.73it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.61it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 55.88it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 57.87it/s]backtest loop:  57%|█████▋    | 555/971 [00:09<00:07, 59.26it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.36it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.19it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.51it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.53it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.40it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.66it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 56.32it/s]backtest loop:  63%|██████▎   | 608/971 [00:10<00:06, 58.12it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.46it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:05, 58.32it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.45it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.66it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 58.44it/s]backtest loop:  67%|██████▋   | 648/971 [00:11<00:05, 58.54it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 56.54it/s]backtest loop:  68%|██████▊   | 662/971 [00:11<00:05, 58.38it/s]backtest loop:  69%|██████▉   | 669/971 [00:11<00:05, 59.65it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:08, 34.52it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:07, 39.05it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:06, 44.33it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:06, 45.69it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:05, 50.04it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 53.45it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 52.45it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 55.36it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 57.50it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 52.23it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.19it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.31it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.75it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.30it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.28it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.56it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.78it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.51it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.70it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 59.03it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.12it/s]backtest loop:  84%|████████▍ | 814/971 [00:14<00:02, 56.73it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 57.42it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 58.89it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.98it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 58.00it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 59.50it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 56.44it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 58.46it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.80it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.17it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 58.16it/s]backtest loop:  91%|█████████ | 886/971 [00:15<00:01, 59.67it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.58it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.48it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.83it/s]backtest loop:  94%|█████████▍| 913/971 [00:16<00:01, 57.23it/s]backtest loop:  95%|█████████▍| 920/971 [00:16<00:00, 58.85it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.18it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 58.22it/s]backtest loop:  97%|█████████▋| 940/971 [00:16<00:00, 56.34it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 58.18it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 59.71it/s]backtest loop:  99%|█████████▉| 961/971 [00:17<00:00, 57.14it/s]backtest loop: 100%|█████████▉| 968/971 [00:17<00:00, 58.70it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.68it/s]
[2889964:MainThread](2024-04-24 20:38:53,239) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000492
std                0.004377
annualized_return  0.117180
information_ratio  1.735177
max_drawdown      -0.057311
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000294
std                0.004379
annualized_return  0.070062
information_ratio  1.037157
max_drawdown      -0.061361
[2889964:MainThread](2024-04-24 20:38:53,253) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 9 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843,
                                                    0.0808416950970217,
                                                    0.0996519777534036,
                                                    0.1350500661020691,
                                                    0.08673549373228509,
                                                    0.06064898958727187,
                                                    0.10272142829551463,
                                                    0.07006236711847202],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686,
                                                    1.0290283224191858,
                                                    1.3288466329341255,
                                                    1.7715617081459447,
                                                    1.0261021848895757,
                                                    0.771966296022316,
                                                    1.3388396010553556,
                                                    1.0371568109588447],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668,
                                               -0.07834368021112156,
                                               -0.059689452422237055,
                                               -0.06645825334168459,
                                               -0.10258366610555786,
                                               -0.07525497703661124,
                                               -0.100956308901751,
                                               -0.06136126606948228],
 'IC': [0.034938309895588854,
        0.0319837277968849,
        0.03141600330561671,
        0.03601765321449007,
        0.03380152540822865,
        0.03338627558833016,
        0.03214986770435822,
        0.03597586118951254,
        0.032964882175772085],
 'ICIR': [0.26443813642226155,
          0.2333118121315035,
          0.22755918801990918,
          0.2632967467218964,
          0.2529182417542293,
          0.23438551738157165,
          0.23491928754221703,
          0.27962096857224755,
          0.2519853372930829],
 'Rank IC': [0.03540672677594329,
             0.03222908078267821,
             0.031007041976178422,
             0.034138872222944594,
             0.03387218004281943,
             0.0337131091887525,
             0.030943839617321976,
             0.03558015813347795,
             0.0334892818005265],
 'Rank ICIR': [0.2681827971385148,
               0.2361252561206688,
               0.22721725134268647,
               0.25237618187243605,
               0.2518726819292428,
               0.2399643053036326,
               0.23063933725249786,
               0.2773735721980436,
               0.2583934641320263],
 'mae': [0.7074260711669922,
         0.7075468897819519,
         0.7075085043907166,
         0.7075332999229431,
         0.7074981927871704,
         0.7074288129806519,
         0.7075015902519226,
         0.7074750661849976,
         0.7076835632324219],
 'mse': [0.9966168403625488,
         0.9963537454605103,
         0.9966068863868713,
         0.9964209198951721,
         0.9963500499725342,
         0.9963279366493225,
         0.9966430068016052,
         0.996695339679718,
         0.9966146349906921]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2889964:MainThread](2024-04-24 20:38:54,415) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2889964:MainThread](2024-04-24 20:38:54,415) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2889964:MainThread](2024-04-24 20:38:54,417) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2889964:MainThread](2024-04-24 20:38:54,417) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:26,  7.54s/it]epoch:   2%|▏         | 2/100 [00:14<12:01,  7.36s/it]epoch:   3%|▎         | 3/100 [00:21<11:47,  7.30s/it]epoch:   4%|▍         | 4/100 [00:29<11:46,  7.36s/it]epoch:   5%|▌         | 5/100 [00:36<11:39,  7.36s/it]epoch:   6%|▌         | 6/100 [00:44<11:27,  7.31s/it]epoch:   7%|▋         | 7/100 [00:51<11:14,  7.25s/it]epoch:   8%|▊         | 8/100 [00:58<11:06,  7.24s/it]epoch:   9%|▉         | 9/100 [01:05<10:57,  7.23s/it]epoch:  10%|█         | 10/100 [01:12<10:47,  7.19s/it]epoch:  11%|█         | 11/100 [01:20<10:46,  7.26s/it]epoch:  12%|█▏        | 12/100 [01:27<10:39,  7.27s/it]epoch:  13%|█▎        | 13/100 [01:34<10:35,  7.31s/it]epoch:  14%|█▍        | 14/100 [01:42<10:26,  7.29s/it]epoch:  15%|█▌        | 15/100 [01:49<10:21,  7.31s/it]epoch:  16%|█▌        | 16/100 [01:56<10:12,  7.30s/it]epoch:  17%|█▋        | 17/100 [02:03<10:05,  7.29s/it]epoch:  18%|█▊        | 18/100 [02:11<09:52,  7.23s/it]epoch:  19%|█▉        | 19/100 [02:18<09:48,  7.27s/it]epoch:  20%|██        | 20/100 [02:25<09:45,  7.31s/it]epoch:  21%|██        | 21/100 [02:33<09:38,  7.33s/it]epoch:  22%|██▏       | 22/100 [02:40<09:28,  7.28s/it]epoch:  23%|██▎       | 23/100 [02:47<09:18,  7.25s/it]epoch:  24%|██▍       | 24/100 [02:54<09:12,  7.26s/it]epoch:  25%|██▌       | 25/100 [03:02<09:03,  7.25s/it]epoch:  26%|██▌       | 26/100 [03:09<08:54,  7.22s/it]epoch:  27%|██▋       | 27/100 [03:16<08:48,  7.24s/it]epoch:  28%|██▊       | 28/100 [03:23<08:43,  7.28s/it]epoch:  29%|██▉       | 29/100 [03:31<08:35,  7.26s/it]epoch:  30%|███       | 30/100 [03:38<08:27,  7.25s/it]0.05532325572954148
best ic: 0.05532325572954148
epoch:  31%|███       | 31/100 [03:46<08:41,  7.56s/it]0.06180472700838286
best ic: 0.06180472700838286
epoch:  32%|███▏      | 32/100 [03:54<08:49,  7.78s/it]0.054477498709997685
epoch:  33%|███▎      | 33/100 [04:03<08:52,  7.95s/it]0.0622219814265037
best ic: 0.0622219814265037
epoch:  34%|███▍      | 34/100 [04:11<08:55,  8.11s/it]0.0607177600400587
epoch:  35%|███▌      | 35/100 [04:20<08:56,  8.25s/it]0.055887063678104226
epoch:  36%|███▌      | 36/100 [04:28<08:51,  8.30s/it]0.05626873053852646
epoch:  37%|███▋      | 37/100 [04:36<08:41,  8.28s/it]0.054763514851371285
epoch:  38%|███▊      | 38/100 [04:45<08:32,  8.26s/it]0.058883028583851076
epoch:  39%|███▉      | 39/100 [04:53<08:25,  8.28s/it]0.05570478945379532
epoch:  40%|████      | 40/100 [05:01<08:18,  8.31s/it]0.056121021895858735
epoch:  41%|████      | 41/100 [05:10<08:11,  8.34s/it]0.0543685432175631
epoch:  41%|████      | 41/100 [05:18<07:38,  7.78s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2889964:MainThread](2024-04-24 20:44:13,269) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[2889964:MainThread](2024-04-24 20:44:13,280) INFO - qlib.workflow - [recorder.py:341] - Recorder 7278c2a60c234659a6f7d3214b538c42 starts running under Experiment 35 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.05it/s]online:   6%|▋         | 4/63 [00:00<00:03, 15.81it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.34it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.34it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.29it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.45it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.58it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.48it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.47it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.69it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.51it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.48it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.44it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.46it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 16.53it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.57it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.52it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.53it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.51it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.64it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.68it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.74it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.63it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.70it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.60it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.63it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.66it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.72it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.69it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.66it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.75it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.57it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2889964:MainThread](2024-04-24 20:44:25,650) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99667805 mae 0.7074844
{'IC': 0.03463143467624617,
 'ICIR': 0.264620797655476,
 'Rank IC': 0.03427950068545863,
 'Rank ICIR': 0.26438630582301187}
[2889964:MainThread](2024-04-24 20:44:27,341) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2889964:MainThread](2024-04-24 20:44:39,808) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:44:39,811) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2889964:MainThread](2024-04-24 20:44:45,867) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa6acfea790>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:48,  8.96it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.15it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:26, 36.60it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.36it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.75it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.65it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.37it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:17, 54.02it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.56it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.32it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.69it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.36it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 59.02it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.23it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:14, 58.48it/s]backtest loop:  10%|█         | 100/971 [00:02<00:14, 58.85it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.90it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.48it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.92it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 54.56it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 56.90it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.93it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.31it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.76it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.96it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 58.10it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.47it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:13, 56.80it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.45it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.58it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.26it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:13, 58.30it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 56.03it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.18it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.69it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:12, 57.31it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.86it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 58.05it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 58.29it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.48it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:12, 54.77it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 57.16it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.63it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 56.09it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 57.88it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.39it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 54.87it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:11, 56.21it/s]backtest loop:  33%|███▎      | 318/971 [00:05<00:11, 58.32it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.11it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.43it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.79it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.18it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.71it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.53it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.21it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.45it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 55.95it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 58.04it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.33it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.48it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 58.97it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.52it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 58.21it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 59.45it/s]backtest loop:  45%|████▍     | 433/971 [00:07<00:09, 56.37it/s]backtest loop:  45%|████▌     | 440/971 [00:07<00:09, 58.17it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 56.35it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 58.15it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.47it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.47it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 58.31it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.58it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.12it/s]backtest loop:  51%|█████     | 494/971 [00:08<00:08, 58.12it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.55it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.90it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:07, 57.21it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 59.04it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 56.22it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 58.10it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 56.43it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 58.25it/s]backtest loop:  57%|█████▋    | 555/971 [00:09<00:06, 59.85it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 57.47it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 59.00it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:06, 56.98it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 58.83it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 60.07it/s]backtest loop:  61%|██████▏   | 597/971 [00:10<00:06, 57.70it/s]backtest loop:  62%|██████▏   | 604/971 [00:10<00:06, 59.18it/s]backtest loop:  63%|██████▎   | 610/971 [00:10<00:06, 56.27it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:10, 35.12it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:08, 40.79it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:07, 43.87it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:06, 48.18it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:06, 51.86it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:06, 51.08it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 54.18it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 56.61it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 54.60it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.00it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 57.75it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.27it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.45it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 59.09it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 56.03it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 58.07it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 59.53it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.57it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.64it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 57.03it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.77it/s]backtest loop:  78%|███████▊  | 754/971 [00:13<00:03, 56.03it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 54.06it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 56.61it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 58.49it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.85it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.88it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 55.39it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:02, 57.46it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 59.10it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 56.10it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 58.03it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 59.39it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 56.41it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 58.25it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 59.44it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 56.53it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 58.48it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 56.46it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 58.18it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 59.50it/s]backtest loop:  91%|█████████▏| 887/971 [00:15<00:01, 56.55it/s]backtest loop:  92%|█████████▏| 893/971 [00:16<00:01, 57.37it/s]backtest loop:  93%|█████████▎| 900/971 [00:16<00:01, 59.10it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 56.99it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 58.72it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 56.66it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 58.42it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 59.73it/s]backtest loop:  97%|█████████▋| 942/971 [00:16<00:00, 57.05it/s]backtest loop:  98%|█████████▊| 949/971 [00:17<00:00, 58.77it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 56.20it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 58.05it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 59.44it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.71it/s]
[2889964:MainThread](2024-04-24 20:45:03,364) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000552
std                0.004922
annualized_return  0.131271
information_ratio  1.728914
max_drawdown      -0.087480
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000355
std                0.004922
annualized_return  0.084424
information_ratio  1.111745
max_drawdown      -0.103317
[2889964:MainThread](2024-04-24 20:45:03,378) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 35
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_online`.
Round 10 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06740146173097197,
                                                    0.11831640029449843,
                                                    0.0808416950970217,
                                                    0.0996519777534036,
                                                    0.1350500661020691,
                                                    0.08673549373228509,
                                                    0.06064898958727187,
                                                    0.10272142829551463,
                                                    0.07006236711847202,
                                                    0.08442392882623409],
 '1day.excess_return_with_cost.information_ratio': [0.8851765797270427,
                                                    1.6246691447630686,
                                                    1.0290283224191858,
                                                    1.3288466329341255,
                                                    1.7715617081459447,
                                                    1.0261021848895757,
                                                    0.771966296022316,
                                                    1.3388396010553556,
                                                    1.0371568109588447,
                                                    1.1117446186962145],
 '1day.excess_return_with_cost.max_drawdown': [-0.1399557750050198,
                                               -0.08871836824329668,
                                               -0.07834368021112156,
                                               -0.059689452422237055,
                                               -0.06645825334168459,
                                               -0.10258366610555786,
                                               -0.07525497703661124,
                                               -0.100956308901751,
                                               -0.06136126606948228,
                                               -0.10331727803732937],
 'IC': [0.034938309895588854,
        0.0319837277968849,
        0.03141600330561671,
        0.03601765321449007,
        0.03380152540822865,
        0.03338627558833016,
        0.03214986770435822,
        0.03597586118951254,
        0.032964882175772085,
        0.03463143467624617],
 'ICIR': [0.26443813642226155,
          0.2333118121315035,
          0.22755918801990918,
          0.2632967467218964,
          0.2529182417542293,
          0.23438551738157165,
          0.23491928754221703,
          0.27962096857224755,
          0.2519853372930829,
          0.264620797655476],
 'Rank IC': [0.03540672677594329,
             0.03222908078267821,
             0.031007041976178422,
             0.034138872222944594,
             0.03387218004281943,
             0.0337131091887525,
             0.030943839617321976,
             0.03558015813347795,
             0.0334892818005265,
             0.03427950068545863],
 'Rank ICIR': [0.2681827971385148,
               0.2361252561206688,
               0.22721725134268647,
               0.25237618187243605,
               0.2518726819292428,
               0.2399643053036326,
               0.23063933725249786,
               0.2773735721980436,
               0.2583934641320263,
               0.26438630582301187],
 'mae': [0.7074260711669922,
         0.7075468897819519,
         0.7075085043907166,
         0.7075332999229431,
         0.7074981927871704,
         0.7074288129806519,
         0.7075015902519226,
         0.7074750661849976,
         0.7076835632324219,
         0.7074844241142273],
 'mse': [0.9966168403625488,
         0.9963537454605103,
         0.9966068863868713,
         0.9964209198951721,
         0.9963500499725342,
         0.9963279366493225,
         0.9966430068016052,
         0.996695339679718,
         0.9966146349906921,
         0.9966780543327332]}
[2889964:MainThread](2024-04-24 20:45:04,580) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_final.
[2889964:MainThread](2024-04-24 20:45:04,605) INFO - qlib.workflow - [exp.py:258] - Experiment 36 starts running ...
[2889964:MainThread](2024-04-24 20:45:04,644) INFO - qlib.workflow - [recorder.py:341] - Recorder 93dbf09cf39c477193d4286176db5b0d starts running under Experiment 36 ...
Time cost: 312.3908603668213	52.63464605808258
Final results:
{'1day.excess_return_with_cost.annualized_return': [0.09058538085377425,
                                                    0.022311890899463636],
 '1day.excess_return_with_cost.information_ratio': [1.1925091899611673,
                                                    0.30305919469571696],
 '1day.excess_return_with_cost.max_drawdown': [-0.08766390253740913,
                                               0.023547385160644887],
 'IC': [0.033726554095502834, 0.0015543249747055827],
 'ICIR': [0.25070560334943953, 0.016544598243977193],
 'Rank IC': [0.03346597912261016, 0.0015334584882265682],
 'Rank ICIR': [0.2506531153112761, 0.015966661416814947],
 'mae': [0.7075086414813996, 6.908815514362473e-05],
 'mse': [0.9965307414531708, 0.00014100139132167507]}
Your final results can be found in the experiment named `csi300_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_19:44:14_final`.
All Done!
[2889964:MainThread](2024-04-24 20:45:05,517) INFO - qlib.timer - [log.py:127] - Time cost: 0.033s | waiting `async_log` Done

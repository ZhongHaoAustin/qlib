[3964344:MainThread](2024-04-26 21:46:28,168) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3964344:MainThread](2024-04-26 21:46:28,171) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3964344:MainThread](2024-04-26 21:46:28,171) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3964344:MainThread](2024-04-26 21:46:47,110) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  24%|██▍       | 36/147 [00:00<00:00, 352.61it/s]creating meta tasks:  51%|█████     | 75/147 [00:00<00:00, 371.23it/s]creating meta tasks:  78%|███████▊  | 114/147 [00:00<00:00, 379.71it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 378.00it/s]
[3964344:MainThread](2024-04-26 21:46:47,777) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  63%|██████▎   | 40/63 [00:00<00:00, 394.26it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 393.37it/s]
Traceback (most recent call last):
  File "/home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/incremental/main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3964344:MainThread](2024-04-26 21:46:50,054) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3964344:MainThread](2024-04-26 21:46:50,126) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3964344:MainThread](2024-04-26 21:46:50,128) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3964344:MainThread](2024-04-26 21:46:50,128) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3964344:MainThread](2024-04-26 21:46:58,432) INFO - qlib.workflow - [exp.py:258] - Experiment 112 starts running ...
[3964344:MainThread](2024-04-26 21:47:00,335) INFO - qlib.workflow - [recorder.py:351] - Recorder 0fbbe47e97174bc6a96a47c5ed89f049 starts running under Experiment 112 ...
[3964344:MainThread](2024-04-26 21:47:09,359) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3964344:MainThread](2024-04-26 21:47:09,360) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3964344:MainThread](2024-04-26 21:47:09,360) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:13,781) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:14,058) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994609
[3964344:MainThread](2024-04-26 21:47:14,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3964344:MainThread](2024-04-26 21:47:14,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:18,259) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:18,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992779
[3964344:MainThread](2024-04-26 21:47:18,544) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3964344:MainThread](2024-04-26 21:47:18,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:22,840) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:23,124) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993722
[3964344:MainThread](2024-04-26 21:47:23,125) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3964344:MainThread](2024-04-26 21:47:23,125) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:27,055) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:27,331) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994122
[3964344:MainThread](2024-04-26 21:47:27,331) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3964344:MainThread](2024-04-26 21:47:27,332) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:31,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:31,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993921
[3964344:MainThread](2024-04-26 21:47:31,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3964344:MainThread](2024-04-26 21:47:31,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:35,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:35,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994498
[3964344:MainThread](2024-04-26 21:47:35,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3964344:MainThread](2024-04-26 21:47:35,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:39,780) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:40,054) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993013
[3964344:MainThread](2024-04-26 21:47:40,054) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3964344:MainThread](2024-04-26 21:47:40,055) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:44,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:44,351) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996212
[3964344:MainThread](2024-04-26 21:47:44,351) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3964344:MainThread](2024-04-26 21:47:44,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:48,398) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:48,675) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995818
[3964344:MainThread](2024-04-26 21:47:48,675) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3964344:MainThread](2024-04-26 21:47:48,675) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3964344:MainThread](2024-04-26 21:47:52,626) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3964344:MainThread](2024-04-26 21:47:52,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995187
[3964344:MainThread](2024-04-26 21:47:52,904) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3964344:MainThread](2024-04-26 21:47:52,904) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992779 @ 1
[3964344:MainThread](2024-04-26 21:47:52,918) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankFalse_43.
[3964344:MainThread](2024-04-26 21:47:53,225) ERROR - qlib.workflow - [utils.py:41] - An exception has been raised[AttributeError: 'CML' object has no attribute 'is_rnn'].
  File "main.py", line 62, in <module>
    fire.Fire(CML)
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib_new/lib/python3.8/site-packages/fire/core.py", line 143, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib_new/lib/python3.8/site-packages/fire/core.py", line 477, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib_new/lib/python3.8/site-packages/fire/core.py", line 693, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/incremental/main.py", line 490, in run_all
    mm = self.offline_training(seed=43 + i)
  File "main.py", line 40, in offline_training
    is_rnn=self.is_rnn,
AttributeError: 'CML' object has no attribute 'is_rnn'

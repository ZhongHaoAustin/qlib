[3430421:MainThread](2024-04-25 20:53:35,686) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3430421:MainThread](2024-04-25 20:53:35,689) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3430421:MainThread](2024-04-25 20:53:35,689) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3430421:MainThread](2024-04-25 20:53:53,126) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  26%|██▌       | 38/147 [00:00<00:00, 377.14it/s]creating meta tasks:  54%|█████▍    | 80/147 [00:00<00:00, 400.59it/s]creating meta tasks:  83%|████████▎ | 122/147 [00:00<00:00, 408.18it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 406.50it/s]
[3430421:MainThread](2024-04-25 20:53:53,755) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  63%|██████▎   | 40/63 [00:00<00:00, 397.28it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 396.73it/s]
Traceback (most recent call last):
  File "/home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/incremental/main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3430421:MainThread](2024-04-25 20:53:54,517) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3430421:MainThread](2024-04-25 20:53:54,592) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3430421:MainThread](2024-04-25 20:53:54,594) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3430421:MainThread](2024-04-25 20:53:54,594) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3430421:MainThread](2024-04-25 20:54:01,879) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankFalse_43.
[3430421:MainThread](2024-04-25 20:54:02,006) INFO - qlib.workflow - [exp.py:258] - Experiment 112 starts running ...
[3430421:MainThread](2024-04-25 20:54:03,917) INFO - qlib.workflow - [recorder.py:341] - Recorder 4afc7db891ac457680504de80d761e0b starts running under Experiment 112 ...
[3430421:MainThread](2024-04-25 20:54:13,083) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3430421:MainThread](2024-04-25 20:54:13,084) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3430421:MainThread](2024-04-25 20:54:13,084) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:17,888) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:18,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994609
[3430421:MainThread](2024-04-25 20:54:18,167) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3430421:MainThread](2024-04-25 20:54:18,167) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:22,166) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:22,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992779
[3430421:MainThread](2024-04-25 20:54:22,447) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3430421:MainThread](2024-04-25 20:54:22,448) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:26,598) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:26,875) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993722
[3430421:MainThread](2024-04-25 20:54:26,876) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3430421:MainThread](2024-04-25 20:54:26,876) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:30,776) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:31,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994122
[3430421:MainThread](2024-04-25 20:54:31,053) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3430421:MainThread](2024-04-25 20:54:31,053) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:34,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:35,210) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993921
[3430421:MainThread](2024-04-25 20:54:35,210) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3430421:MainThread](2024-04-25 20:54:35,210) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:39,132) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:39,408) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994498
[3430421:MainThread](2024-04-25 20:54:39,408) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3430421:MainThread](2024-04-25 20:54:39,409) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:43,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:43,678) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993013
[3430421:MainThread](2024-04-25 20:54:43,679) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3430421:MainThread](2024-04-25 20:54:43,679) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:47,782) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:48,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996212
[3430421:MainThread](2024-04-25 20:54:48,060) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3430421:MainThread](2024-04-25 20:54:48,061) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:52,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:52,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995818
[3430421:MainThread](2024-04-25 20:54:52,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3430421:MainThread](2024-04-25 20:54:52,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3430421:MainThread](2024-04-25 20:54:56,271) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3430421:MainThread](2024-04-25 20:54:56,547) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995187
[3430421:MainThread](2024-04-25 20:54:56,548) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3430421:MainThread](2024-04-25 20:54:56,548) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992779 @ 1
[3430421:MainThread](2024-04-25 20:54:56,700) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankFalse_43.
[3430421:MainThread](2024-04-25 20:54:56,956) ERROR - qlib.workflow - [utils.py:41] - An exception has been raised[AttributeError: 'CML' object has no attribute 'is_rnn'].
  File "main.py", line 62, in <module>
    fire.Fire(CML)
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/fire/core.py", line 143, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/fire/core.py", line 477, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/fire/core.py", line 693, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/incremental/main.py", line 490, in run_all
    mm = self.offline_training(seed=43 + i)
  File "main.py", line 40, in offline_training
    is_rnn=self.is_rnn,
AttributeError: 'CML' object has no attribute 'is_rnn'

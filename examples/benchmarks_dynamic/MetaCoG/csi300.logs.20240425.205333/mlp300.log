[3432784:MainThread](2024-04-25 20:59:38,968) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3432784:MainThread](2024-04-25 20:59:38,971) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3432784:MainThread](2024-04-25 20:59:38,971) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.001, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3432784:MainThread](2024-04-25 20:59:45,259) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.001, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  26%|██▌       | 38/147 [00:00<00:00, 377.70it/s]creating meta tasks:  54%|█████▍    | 80/147 [00:00<00:00, 400.77it/s]creating meta tasks:  83%|████████▎ | 122/147 [00:00<00:00, 407.81it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 406.06it/s]
[3432784:MainThread](2024-04-25 20:59:45,895) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.001, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  65%|██████▌   | 41/63 [00:00<00:00, 406.47it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 411.98it/s]
Traceback (most recent call last):
  File "/home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/incremental/main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.001, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3432784:MainThread](2024-04-25 20:59:46,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3432784:MainThread](2024-04-25 20:59:46,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3432784:MainThread](2024-04-25 20:59:46,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3432784:MainThread](2024-04-25 20:59:46,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3432784:MainThread](2024-04-25 20:59:51,985) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankFalse_43.
[3432784:MainThread](2024-04-25 20:59:52,120) INFO - qlib.workflow - [exp.py:258] - Experiment 116 starts running ...
[3432784:MainThread](2024-04-25 20:59:53,714) INFO - qlib.workflow - [recorder.py:341] - Recorder 0b8d0c7921a74616ac5292564ee4601d starts running under Experiment 116 ...
[3432784:MainThread](2024-04-25 21:00:01,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3432784:MainThread](2024-04-25 21:00:03,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.240494, valid_loss 1.082314, train_metric nan, valid_metric 0.018637
[3432784:MainThread](2024-04-25 21:00:03,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.082314, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:03,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.104305, valid_loss 1.020996, train_metric nan, valid_metric 0.018026
[3432784:MainThread](2024-04-25 21:00:03,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.082314 to 1.020996, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:03,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.068675, valid_loss 1.014398, train_metric nan, valid_metric 0.024305
[3432784:MainThread](2024-04-25 21:00:03,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.020996 to 1.014398, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:03,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.053090, valid_loss 1.015648, train_metric nan, valid_metric 0.011806
[3432784:MainThread](2024-04-25 21:00:04,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.046856, valid_loss 1.012319, train_metric nan, valid_metric 0.025310
[3432784:MainThread](2024-04-25 21:00:04,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014398 to 1.012319, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:04,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.042854, valid_loss 1.006265, train_metric nan, valid_metric 0.032365
[3432784:MainThread](2024-04-25 21:00:04,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.012319 to 1.006265, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:04,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.033400, valid_loss 1.002319, train_metric nan, valid_metric 0.030287
[3432784:MainThread](2024-04-25 21:00:04,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006265 to 1.002319, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:05,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.037356, valid_loss 1.001528, train_metric nan, valid_metric 0.037318
[3432784:MainThread](2024-04-25 21:00:05,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002319 to 1.001528, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:05,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.024483, valid_loss 1.010299, train_metric nan, valid_metric 0.024334
[3432784:MainThread](2024-04-25 21:00:05,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.020535, valid_loss 1.005377, train_metric nan, valid_metric 0.019825
[3432784:MainThread](2024-04-25 21:00:05,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.017416, valid_loss 1.003045, train_metric nan, valid_metric 0.021458
[3432784:MainThread](2024-04-25 21:00:05,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.028231, valid_loss 1.002645, train_metric nan, valid_metric 0.023844
[3432784:MainThread](2024-04-25 21:00:06,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.024577, valid_loss 1.000011, train_metric nan, valid_metric 0.040846
[3432784:MainThread](2024-04-25 21:00:06,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001528 to 1.000011, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:06,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.024087, valid_loss 1.003609, train_metric nan, valid_metric 0.048054
[3432784:MainThread](2024-04-25 21:00:06,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.015023, valid_loss 0.998243, train_metric nan, valid_metric 0.042535
[3432784:MainThread](2024-04-25 21:00:06,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000011 to 0.998243, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:06,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.011584, valid_loss 1.001040, train_metric nan, valid_metric 0.022618
[3432784:MainThread](2024-04-25 21:00:07,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.019582, valid_loss 0.999360, train_metric nan, valid_metric 0.039026
[3432784:MainThread](2024-04-25 21:00:07,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.015867, valid_loss 0.999375, train_metric nan, valid_metric 0.045037
[3432784:MainThread](2024-04-25 21:00:07,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.021050, valid_loss 1.000967, train_metric nan, valid_metric 0.024196
[3432784:MainThread](2024-04-25 21:00:07,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.016566, valid_loss 1.003243, train_metric nan, valid_metric 0.024602
[3432784:MainThread](2024-04-25 21:00:08,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.007044, valid_loss 1.001442, train_metric nan, valid_metric 0.043106
[3432784:MainThread](2024-04-25 21:00:08,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.000289, valid_loss 0.999307, train_metric nan, valid_metric 0.032710
[3432784:MainThread](2024-04-25 21:00:08,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.008088, valid_loss 0.999624, train_metric nan, valid_metric 0.047026
[3432784:MainThread](2024-04-25 21:00:08,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.009187, valid_loss 0.998254, train_metric nan, valid_metric 0.039079
[3432784:MainThread](2024-04-25 21:00:08,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.021643, valid_loss 1.000259, train_metric nan, valid_metric 0.053897
[3432784:MainThread](2024-04-25 21:00:09,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.021463, valid_loss 1.002542, train_metric nan, valid_metric 0.021928
[3432784:MainThread](2024-04-25 21:00:09,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.024037, valid_loss 0.998962, train_metric nan, valid_metric 0.042073
[3432784:MainThread](2024-04-25 21:00:09,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.006253, valid_loss 0.997610, train_metric nan, valid_metric 0.040814
[3432784:MainThread](2024-04-25 21:00:09,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998243 to 0.997610, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:09,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.011430, valid_loss 0.997610, train_metric nan, valid_metric 0.041527
[3432784:MainThread](2024-04-25 21:00:10,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.999381, valid_loss 1.003610, train_metric nan, valid_metric 0.018622
[3432784:MainThread](2024-04-25 21:00:10,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.007712, valid_loss 0.998791, train_metric nan, valid_metric 0.032468
[3432784:MainThread](2024-04-25 21:00:10,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.007421, valid_loss 0.999490, train_metric nan, valid_metric 0.036686
[3432784:MainThread](2024-04-25 21:00:10,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.009201, valid_loss 0.997530, train_metric nan, valid_metric 0.038769
[3432784:MainThread](2024-04-25 21:00:10,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997610 to 0.997530, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:11,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.005114, valid_loss 0.998555, train_metric nan, valid_metric 0.043561
[3432784:MainThread](2024-04-25 21:00:11,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.008582, valid_loss 1.000259, train_metric nan, valid_metric 0.033461
[3432784:MainThread](2024-04-25 21:00:11,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.987192, valid_loss 0.997397, train_metric nan, valid_metric 0.044117
[3432784:MainThread](2024-04-25 21:00:11,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997530 to 0.997397, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:11,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.988974, valid_loss 1.002351, train_metric nan, valid_metric 0.020723
[3432784:MainThread](2024-04-25 21:00:11,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.997250, valid_loss 0.999985, train_metric nan, valid_metric 0.031737
[3432784:MainThread](2024-04-25 21:00:12,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.994674, valid_loss 1.000308, train_metric nan, valid_metric 0.025870
[3432784:MainThread](2024-04-25 21:00:12,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.997803, valid_loss 1.002527, train_metric nan, valid_metric 0.020248
[3432784:MainThread](2024-04-25 21:00:12,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.009711, valid_loss 0.998235, train_metric nan, valid_metric 0.040004
[3432784:MainThread](2024-04-25 21:00:13,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.989611, valid_loss 0.997469, train_metric nan, valid_metric 0.046708
[3432784:MainThread](2024-04-25 21:00:13,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.991031, valid_loss 0.998698, train_metric nan, valid_metric 0.028816
[3432784:MainThread](2024-04-25 21:00:13,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.004280, valid_loss 1.001269, train_metric nan, valid_metric 0.026758
[3432784:MainThread](2024-04-25 21:00:13,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.993149, valid_loss 0.998915, train_metric nan, valid_metric 0.037615
[3432784:MainThread](2024-04-25 21:00:14,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.002136, valid_loss 0.996811, train_metric nan, valid_metric 0.052758
[3432784:MainThread](2024-04-25 21:00:14,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997397 to 0.996811, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:14,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.003680, valid_loss 0.997699, train_metric nan, valid_metric 0.036966
[3432784:MainThread](2024-04-25 21:00:14,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.000283, valid_loss 0.997444, train_metric nan, valid_metric 0.042395
[3432784:MainThread](2024-04-25 21:00:14,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.015571, valid_loss 1.001596, train_metric nan, valid_metric 0.037980
[3432784:MainThread](2024-04-25 21:00:15,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.014177, valid_loss 0.996387, train_metric nan, valid_metric 0.043074
[3432784:MainThread](2024-04-25 21:00:15,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996811 to 0.996387, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:15,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.984028, valid_loss 0.996622, train_metric nan, valid_metric 0.054591
[3432784:MainThread](2024-04-25 21:00:15,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.977021, valid_loss 0.996608, train_metric nan, valid_metric 0.043770
[3432784:MainThread](2024-04-25 21:00:15,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.988302, valid_loss 0.997157, train_metric nan, valid_metric 0.053303
[3432784:MainThread](2024-04-25 21:00:16,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.006140, valid_loss 0.997487, train_metric nan, valid_metric 0.038700
[3432784:MainThread](2024-04-25 21:00:16,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.985560, valid_loss 0.997432, train_metric nan, valid_metric 0.047913
[3432784:MainThread](2024-04-25 21:00:16,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.995951, valid_loss 0.999539, train_metric nan, valid_metric 0.034420
[3432784:MainThread](2024-04-25 21:00:16,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.012170, valid_loss 0.999320, train_metric nan, valid_metric 0.033792
[3432784:MainThread](2024-04-25 21:00:17,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.982595, valid_loss 1.000202, train_metric nan, valid_metric 0.029498
[3432784:MainThread](2024-04-25 21:00:17,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.985196, valid_loss 0.998256, train_metric nan, valid_metric 0.039080
[3432784:MainThread](2024-04-25 21:00:17,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.994090, valid_loss 0.996178, train_metric nan, valid_metric 0.049776
[3432784:MainThread](2024-04-25 21:00:17,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996387 to 0.996178, save checkpoint.
[3432784:MainThread](2024-04-25 21:00:17,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.989768, valid_loss 0.996786, train_metric nan, valid_metric 0.054253
[3432784:MainThread](2024-04-25 21:00:18,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.983364, valid_loss 1.001591, train_metric nan, valid_metric 0.021838
[3432784:MainThread](2024-04-25 21:00:18,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.997846, valid_loss 0.997179, train_metric nan, valid_metric 0.044271
[3432784:MainThread](2024-04-25 21:00:18,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.996296, valid_loss 1.002156, train_metric nan, valid_metric 0.028478
[3432784:MainThread](2024-04-25 21:00:18,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.983614, valid_loss 0.997577, train_metric nan, valid_metric 0.041700
[3432784:MainThread](2024-04-25 21:00:18,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.986202, valid_loss 0.999047, train_metric nan, valid_metric 0.053406
[3432784:MainThread](2024-04-25 21:00:19,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.004357, valid_loss 0.998646, train_metric nan, valid_metric 0.055559
[3432784:MainThread](2024-04-25 21:00:19,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.000774, valid_loss 0.996722, train_metric nan, valid_metric 0.051308
[3432784:MainThread](2024-04-25 21:00:19,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.990019, valid_loss 1.001766, train_metric nan, valid_metric 0.027538
[3432784:MainThread](2024-04-25 21:00:19,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.997155, valid_loss 1.001174, train_metric nan, valid_metric 0.020657
[3432784:MainThread](2024-04-25 21:00:20,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.994825, valid_loss 0.997754, train_metric nan, valid_metric 0.038218
[3432784:MainThread](2024-04-25 21:00:20,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.995717, valid_loss 0.996980, train_metric nan, valid_metric 0.043781
[3432784:MainThread](2024-04-25 21:00:20,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.998763, valid_loss 0.996946, train_metric nan, valid_metric 0.043788
[3432784:MainThread](2024-04-25 21:00:20,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.004705, valid_loss 0.996796, train_metric nan, valid_metric 0.041792
[3432784:MainThread](2024-04-25 21:00:21,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.993782, valid_loss 0.996538, train_metric nan, valid_metric 0.054667
[3432784:MainThread](2024-04-25 21:00:21,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.984837, valid_loss 0.999921, train_metric nan, valid_metric 0.054712
[3432784:MainThread](2024-04-25 21:00:21,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.990331, valid_loss 0.997683, train_metric nan, valid_metric 0.042856
[3432784:MainThread](2024-04-25 21:00:21,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.988997, valid_loss 0.997528, train_metric nan, valid_metric 0.053717
[3432784:MainThread](2024-04-25 21:00:22,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.993299, valid_loss 0.997666, train_metric nan, valid_metric 0.053314
[3432784:MainThread](2024-04-25 21:00:22,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.977962, valid_loss 0.998335, train_metric nan, valid_metric 0.038227
[3432784:MainThread](2024-04-25 21:00:22,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.994079, valid_loss 0.996971, train_metric nan, valid_metric 0.044036
[3432784:MainThread](2024-04-25 21:00:22,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.987092, valid_loss 1.000755, train_metric nan, valid_metric 0.034411
[3432784:MainThread](2024-04-25 21:00:23,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.978260, valid_loss 0.997917, train_metric nan, valid_metric 0.043425
[3432784:MainThread](2024-04-25 21:00:23,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.979077, valid_loss 0.997239, train_metric nan, valid_metric 0.042554
[3432784:MainThread](2024-04-25 21:00:23,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.986090, valid_loss 0.999381, train_metric nan, valid_metric 0.034013
[3432784:MainThread](2024-04-25 21:00:24,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.998445, valid_loss 0.999481, train_metric nan, valid_metric 0.048733
[3432784:MainThread](2024-04-25 21:00:24,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.990272, valid_loss 0.999464, train_metric nan, valid_metric 0.034069
[3432784:MainThread](2024-04-25 21:00:24,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.995873, valid_loss 0.997875, train_metric nan, valid_metric 0.044205
[3432784:MainThread](2024-04-25 21:00:24,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.005913, valid_loss 0.997847, train_metric nan, valid_metric 0.041137
[3432784:MainThread](2024-04-25 21:00:24,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.989467, valid_loss 0.996978, train_metric nan, valid_metric 0.054121
[3432784:MainThread](2024-04-25 21:00:25,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.989867, valid_loss 0.997444, train_metric nan, valid_metric 0.045752
[3432784:MainThread](2024-04-25 21:00:25,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.982611, valid_loss 1.001561, train_metric nan, valid_metric 0.057452
[3432784:MainThread](2024-04-25 21:00:25,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.999388, valid_loss 0.998282, train_metric nan, valid_metric 0.050942
[3432784:MainThread](2024-04-25 21:00:25,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.996632, valid_loss 0.997365, train_metric nan, valid_metric 0.058612
[3432784:MainThread](2024-04-25 21:00:26,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.990946, valid_loss 0.996622, train_metric nan, valid_metric 0.054223
[3432784:MainThread](2024-04-25 21:00:26,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.979629, valid_loss 1.001214, train_metric nan, valid_metric 0.056430
[3432784:MainThread](2024-04-25 21:00:26,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.974392, valid_loss 0.999290, train_metric nan, valid_metric 0.052836
[3432784:MainThread](2024-04-25 21:00:26,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.991727, valid_loss 0.996933, train_metric nan, valid_metric 0.043144
[3432784:MainThread](2024-04-25 21:00:26,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.002385, valid_loss 0.996853, train_metric nan, valid_metric 0.053476
[3432784:MainThread](2024-04-25 21:00:27,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.992079, valid_loss 0.999160, train_metric nan, valid_metric 0.042367
[3432784:MainThread](2024-04-25 21:00:27,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.997229, valid_loss 0.999529, train_metric nan, valid_metric 0.040389
[3432784:MainThread](2024-04-25 21:00:27,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.972228, valid_loss 0.998020, train_metric nan, valid_metric 0.045506
[3432784:MainThread](2024-04-25 21:00:27,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.995244, valid_loss 0.998457, train_metric nan, valid_metric 0.043330
[3432784:MainThread](2024-04-25 21:00:28,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.985103, valid_loss 0.998882, train_metric nan, valid_metric 0.035898
[3432784:MainThread](2024-04-25 21:00:28,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.986476, valid_loss 0.998943, train_metric nan, valid_metric 0.048552
[3432784:MainThread](2024-04-25 21:00:28,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.986290, valid_loss 0.998236, train_metric nan, valid_metric 0.044786
[3432784:MainThread](2024-04-25 21:00:28,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.977016, valid_loss 0.999474, train_metric nan, valid_metric 0.060610
[3432784:MainThread](2024-04-25 21:00:28,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.000604, valid_loss 0.998374, train_metric nan, valid_metric 0.053479
[3432784:MainThread](2024-04-25 21:00:29,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.995300, valid_loss 0.998439, train_metric nan, valid_metric 0.045867
[3432784:MainThread](2024-04-25 21:00:29,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.991190, valid_loss 0.997858, train_metric nan, valid_metric 0.048851
[3432784:MainThread](2024-04-25 21:00:29,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3432784:MainThread](2024-04-25 21:00:29,599) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankFalse_43.
[3432784:MainThread](2024-04-25 21:00:29,897) ERROR - qlib.workflow - [utils.py:41] - An exception has been raised[AttributeError: 'CML' object has no attribute 'is_rnn'].
  File "main.py", line 62, in <module>
    fire.Fire(CML)
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/fire/core.py", line 143, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/fire/core.py", line 477, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/fire/core.py", line 693, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/incremental/main.py", line 490, in run_all
    mm = self.offline_training(seed=43 + i)
  File "main.py", line 40, in offline_training
    is_rnn=self.is_rnn,
AttributeError: 'CML' object has no attribute 'is_rnn'
